/*
#Compiler Settings
PATH := /usr/um/gcc-4.7.0/bin:$(PATH)
LD_LIBRARY_PATH := /usr/um/gcc-4.7.0./lib64
LD_RUN_PATH := /usr/um/gcc-4.7.0/lib64

g++ -lgmpxx -lgmp -std=c++11 -O3 modex.cpp -o modex

Linux caen-vnc14.engin.umich.edu 2.6.32-431.3.1.el6.x86_64 #1 SMP 
Fri Dec 13 06:58:20 EST 2013 x86_64 x86_64 x86_64 GNU/Linux
*/

#include <string> 
#include <stdlib.h>
#include <gmp.h>
#include <iostream>
#include <gmpxx.h>
#include <stdio.h>
#include <stdlib.h>
#include <ctime>
#include <chrono>
#include <map>
#include <utility>
#include <vector>
#include <stdexcept> 
#include <cassert>
#include <iomanip>

typedef std::chrono::high_resolution_clock Clock;
typedef std::chrono::milliseconds milliseconds;

//TODO: Check CRT w/ Montgomery

using namespace std;

//Global caches for montgomery reductions
//Takes in M and T, returns m'
map<pair<mpz_class,mpz_class>, mpz_class> t_m_cache;
//Takes in M, returns Minv and M' [SIGNIFICANT SPEEDUP]
map<mpz_class, pair<mpz_class, mpz_class>> m_cache;

//Generates a b bit prime number
mpz_class generate_prime(int b);
mpz_class square_and_multiply_exp(mpz_class x, mpz_class c, 
	mpz_class a, mpz_class b);
mpz_class montgomery_crt_exp(mpz_class x, mpz_class c, mpz_class a, mpz_class b);
mpz_class chinese_remainder_exp(mpz_class x, mpz_class c,
	mpz_class a, mpz_class b);
mpz_class montgomery_reduction(mpz_class T, long exponent, mpz_class& r, mpz_class& M);
mpz_class montgomery_exp(mpz_class x, mpz_class c, mpz_class a, mpz_class b);
void assert_all_equal(vector<mpz_class>& vec);

int main(int argc, char *argv[])
{
	//Types of exponentiation
	vector<string> function_names = {"S&M", "S&M w/ Mont","CRT", "CRT w/ Mont"};
	vector<bool> active(function_names.size(), true);
	vector<mpz_class (*)(mpz_class, mpz_class, mpz_class, mpz_class)> functions
		= {square_and_multiply_exp, montgomery_exp, chinese_remainder_exp,
			montgomery_crt_exp};

	//Deactivate algorithms as needed
	for(int i = 1; i < argc; i++){
		if(!atoi(argv[i])){
			active[i-1] = false;
		}
	}

	gmp_randstate_t rand_state;
	gmp_randinit_default(rand_state);
	srand(time(NULL));

	Clock::time_point t0 = Clock::now();
	Clock::time_point t1;
	milliseconds ms;

	//t0 = Clock::now();
	mpz_class x, c, n, a, b, result;
	vector<long> base_sizes = {100000, 200000};
	vector<long> prime_sizes = {500, 1000};
	int line_width = 15;
	cout << left;

	//Run algorithms for all pairs of sizes
	for(int i = 0; i < base_sizes.size(); i++){
		for(int j = 0; j < prime_sizes.size(); j++){
			vector<mpz_class> values;
			long num_size = base_sizes[i];
			long prime_size = prime_sizes[j];
			//Generate random x, c, a, b
			mpz_urandomb(x.get_mpz_t(), rand_state, num_size);
			mpz_urandomb(c.get_mpz_t(), rand_state, num_size);
			a = generate_prime(prime_size);
			b = generate_prime(prime_size);

			x = "7907481508258553012889621540290454528837035209425010081407163429720667920861861502156397758248669703685247629677530622476778330494241701764485278624196138781764077548327341860962050304142410888733683018667368872904089522230581647757696669365475574404113480715303781323011157239662298462166591032776551903548766568584210891923124606117744599379538066208386825219720340846593429980585127825713661168842430641907821628191129643801998854186318784266962294711948394633736769921074165940133390101455497537904155830385051727685473545074454241785259732397543961028492840758643482862145737283032984740104878960675775119087513882694861205747483616380757341390921758213746972272043894047893936400758821441077432875109530084338727264389058505089632582954175025561438613724574093507891017643071265798384156910326516091786898459902528076212346328662556266491134614081751368857424199898225500293347626268447366168817372689721720614436521475515563843564380428393781590558058165139732673082239011774802023035805590757270027233107972546489914662155187298560585169454922399780953330418741474964990026088417261196858726252335251696839015570800903491387253569869956784024865300836160243752084679609200890906389136842599440795394781777617104899835936608656607372307248027429213477006168237563859737059048809505545929128049859893568591863895679727252431651470839180735778074347841553268352846938784465167140950634721028515161065637540463510878900323012183912793849913792287274475266944865280106703040576847635796197606946546013049228543644990993614904253244030614487093946184502375375160106417675251271670385318633414972876255803219748239024795526583291530844323766106341212779457445222443394993049384878410478047749396278130130176242056115795467583674644671732890238018106175712196015930420315780400261977137040381904300775538755094557370245578836488555298838830289863845968954086143109491048395681642349927481599497868015678714448904261971506431476506751333600580322234569981664310113779882992749634760815810476829017394721218176823929077426542338205607321226861828426030608649878073764701330792986929813153317964090925380569096481024121477875685923078646338063162289090875358637976791488699931053306598263063526922783220859729586221759787239704840765483049173140763753363393860801959785502529548370043580617353746954136261593071373914762581436845261131925651387627736766264841342967536264892587158427676839821328649993520537743829957643334520060689513217110257328439138518026323498162577830656658759804973446396249114125373285395514351135007777034521795040187078923903637987049632341333959071020770393914813622652768805116506485195397701139927387466951530861190995142265882136709385541145844562121400744031879973276478374731814561808550732498857747114060936873259175305154839890059682627298206769933680400148120152828499678445927128565441756291423759668710499965358716226287971967058464350171275683097892604930157627003122339553643702151464015613459354523810824684552093279777333382828224642290957736015108069833023494112392142838256084076678434562245115407340755452892125044809415268456097863287591247614373736855405728046047662356171090928002408838701746753065945804868186946155850731655905264169818893732914413147366911607236064776178182534507009337704548366842937461783177496461102259373364277147459894466781568143382283113011965567744835048374788700706797261122257958080442759544189288264282617992476922516944097279260736664167576682082307839226569005903877014952326721392321826107010270568417877104907568327213964695334557826397206410406181584725821371556184148267499025101745103571324811110562012488139246893214639068097125112211948430722257558608279668388386075402307034046434195914420212738828376266640087846080101449191656591265356618050602726768438721698795471041638379961291360631029553356931201451736502028680033625194673522151572575165026175660060331622925621012607787004525885358093340768436677427028267754955333617718775260778335596117891781018070410009486514114277541270646159675844103174795540821736740576416556098474760396128473333444879469087463514528714967336134278377019681504599867406359807487111560012662731696769033827144188929092086143970305520036960526507240804684411912003175647404275600738261770591364465057907625413653089242562752147326479536831868388649627368778660026236225060637202335617832403424912633210553024056213986427769587039389812886921227894184201814075483270443248470372245062110313704700537669579822914075886463268114090227097871683532257267611052847480465444292227266796318416069411070942047151939880802856434970498348344831870156073657538932231484018754900824222891262036112281483963911289974778198448210961186526093786392475192051831530640969214003167476740193599492707436149563961191533927254586487932568755109500432265340046792772028880389557966262103273262592693753065658889372830727870320649148118763307207768750004704417031221075599157102547238293778714710783012677568993535282768548840351662886367169705002934071437817857163142873720035635580390797393727263251259015336776093567796548349236939120299362298676761105102913484213086738730994949666467078975247657046094219250489120820814767858890661699159148691488699364848324756659579820118041486233338400103063662310367701876254890127658071819994332869656044462165935852800596483619303653869637601469968872149199247996298527006842443166597361096336878478616070466636739780351219896616757800202590377799764891224231411243377382754101793012768965770434823288817294971875580279433478620638867558978829545724495726411147115867211824494819505375980106800088689052662936659616739097537110880497088477991015562157934614980823264747395422150931042690339030756217896540754952430322300655008715425309144063932826794400088595762661014194996107900328467701183625021595720204775102676743833446085932840340744274579872712231830252386642168622538524670105341339031295752895059651427764328215997487557856393149492279363823432337183705789979466034095698831692309624218597257051851602462655474111644078089474575284149898782591467780062900140233796982969283829221949457893881002968620167821379909172374786402007125784053661149375042909824560790187036674400627193419234772526145312021930800601681030004738653825123735182170243776607382802575645352781905475039416997730335567993785614997763125478767518007265491852812399705753954632634614297462409898217903596954873113348985192897988360046081772318347196379195689092922382224313159669729067834542138700940871065376682152838847983075222541834833293885177196341452972027381448068513986867297234000715345059329181833866103875199151690887887973444812773968277122633322832150043239176052185775896918483967895220967675493061658252666389395372759020192450130002045364531847348474768057515395185089977068530582329527199990893455918755049628234208156109616522146127910165705298227204541338276380980070194440984344771182767055667421186543107221865522002186789845284837967017707657930938685212123924271867735068321956099390440161412883807124565670842197146377828774332380478639413375410936327577059951650004511387418577878154931757134767458958833750146673765550091976699317885634668245397241429671224280269309892099144061957664630001612548606943633441404557141978708254556269046775847563022256996710485347833754496089794100655473924985186921955223057775604091795479926721009273593596504032446895143640865840435502075358356274531763653395194559652332287122729219312344445253482032935323930808617792389618680107253129413818614745360136515263341227299937328338504577344831352025327401339757685598491641968130059380298789459491457280832029944232115546811344931713786849384437900366423782196489318271786042447698287230329779523815408670466232293405993277606715932708217433520703548585663963753486318508055178657199505618723681081111771117412741882138101835462208987173562916990181653862668309081393934542896785047694379901582011914251748717008170271667995709770975452553259928010389883338340905437375605674529886658691878986328339490414414828479982025536081641829498085078804932783820051499188316310972042351004552374043663248364578865178519537397020375635534605749974850390939884573666696538359811507706380628833196382870376429127449052242175048980014072734981147474860242804377935833742140012194480867331433795146098170266321534231186195709912430661944104456258271317703520572172140256886046605596953323016438459901909201292964736206481161597526325666860359315179365092172306884649709050395413382337425550891463136410870238475791644777643794781537940486857841391766386308721376253338152646357250982451099479828926558190653899101622752471619064251059233184305219051006622871929997274747831545284019839533050800641653387000067019330557105146029701902087129039772473684338812747805327452854870162330293809263790919857279852349314724938256527149034295313244010074084545828657160698207662491810247229798570521936476218400685027169687308241993913385412271116795111177359088441101852190070768103531991643797437297108492362243935819783643543097402644244180389902261646096275891753586469522738899152248114154013309795754852305954259554025456725146273931474607809548524676465136983874033729429575910867861806802729637064642389668692725981095697851792507193832110417963567282362625595526518501479765597982491806669835067173008305400489662179991829281400992979897256432700314516629773062692312219280222094542616109969262710338199404158769437711783817381103066506626058637565166427818634089835519108581789794851705861000876577878475105502601625008156381796794253434193999778017310557563423820992783953553567765462947762557528428218715140642400554806364564643417507880955153960237031689692538769471742450232102253402560197757021100006460067046656565046176029708759874226932242999400804081745213800371797943808143361408421818143780382808575919811536001785822606492964591703489906359518238735646187129247859546827748256322964771169104434640072497705513537391237323696980662836100945808279047627388524315337087272066589861367234586179298598404351222780304085219917271679549165941834747402066136462937552789354178310874000948775852944460477902342339760331230305688307476013404636274117500589236979841667100651608711307101169945271965149396064951965761564414769195074461771355577181401437515525234911280700151458743111879669994343852258066354436460751559380510109185630225927048829096345943724349112747899312295699408767760635213456245082650757417603172410117137515118099379647277601661024481651926802369140435679550859676619813459741405053577633979491807024688895898643022085539536726079944490009336627032469472139165253099678802531969917251088759478685838128446792596251943228485041085582740455115479672282505538891033704868666727744713286474863144540000182456939140324586789461833996790647658805116562053165277034355026104629420458224180766739700781601953890888787798466366582938539440438897831331991274206135166836826096036394819292802073904992826604796406471822462000157626658751175258192895378634172432238433657785915788575162173936487817622173159054469504047407947402820915938971332939598933670624961985541060138030117469345160816562408675920637370821848235209907140726083491387551262106895722033298974124204970722391565029460509392647235697952680993294361430984396651996586125549399785219620021597945329366075216273563669409450310682881157608234358265409920649745594135069236499617690725908034847463311371715237256388101390003092394495971486779849727114442101643110445911770818781063473436940732294790429661016092169625145301578415302528111300763240836872773987583568938383726473146041970103929792204025816771310768540248175171317681504387341480503700896256121588010542369531939878621961150025655141740925343944745283130669014130826447282885945800067337656061959626251342077345430963912914891630309801817209205237245344591187099901418633269946118332763470367984167926721127821510266448809033412273121072765255364681640896608176884096259169300903461640392371455203196957739536014717978883686343184769001336194197575018147601106458873198700258931529964938700645339455837762857785020279441516337519866998656823337731396669904484855001428367835999472515099085034677915019179674972385409390552048641855652021886427011476957490104492877731398604685188417936234035898404137906850573292251547185183788880274128244623439547464905938324143801533250668892386624441889381290016838408529346679026204799421880580597238045725918765827036469472390074045104783183315365856501948987776702858082635855229545172497265494813428276092115938938318976536504425720813097095721985581408722331899382987397985442777764865214175906873065255203016979298104449109188127204548938877291864163016606676820760198054758657111207563264589120311346292854750212177185609176247813270830773041831541673097687004073182117054965255355841764437816478639288451658189498297092565593277051971408430629206931793730392081045789637571701251063590722717449455999099963220896910908788530172634237547510162474447658564974247196590116170666771416448142075324984836668596838415557813108001847477460118527483895902463809688281082447149164008375238526092818583943267379050574627070581578256160658773883676124907967977536534862809237283400534188121307477550084029545738153586598219433552583699771953791125164923395296780620611866994941682497830380213820252322603085281346056823514477833694870553179116462989588284665598223227389127192768670929789891868362198778457109159108927375595329212556576807510462091256217555420820115386691223742355560447240675097196539003174595883084062638054720104772388059831574634142803044312277300512107346063368197673700772460270948807188226210620470806225136201786796712440737639783943149731252251892416901061552256337128350586523394648582595000757148059070146368479133011473612000850682460277239974285742433220643927069497229333648510102212232535961263335296677157477429988438620747560991591991345826716146071506985001242737732390014246410364373578783928173279536692582981778897379479437106227153516316053125803465285905157642328780945676098722097666389496910087977035467937370541377277907363239700574200621568324106858079125212760922868972288299848962143999670381371971398960704868254428254142079988124377928428931052602183533666913825710901115813529704873228735436499295488387112644714850382452583086995734256148719424368227677248387417026092305275291631117450717041365045361447876316042507550473012430619300535288357716234883694187719528174261626617576968096915910102035710612240575787011703645380094184430771379252923342765166909369207906571218357625081313422492363687765910545393393336918070685471849505486475219766292426686835801978482369218677875209534546449908005326552048371695742753620569544110017002496796603941042516272009791112033502187094237137851435100542753123214109486230942538818139271304063598500879869050065952622674329489513837528604980027868911346519112234596596702165965616924201053684455390346601523744734587467856570643674309416005641432315780120212711920692432007319381636074843861918473986018187857609450373803425204804202023290979695386089733555048792642072778145534140345364429169380251314885936576682681070684866163997336677811670206900616054418323172161110507081260779045215416869393275881834950976639084836047115284206359444288090353025686513809266345731003674783175862857641198566056384045653528313723781155951494417466410468788019639897050219307622767138057608816112914700173697535622936871066695849329582715960212286381318563862904994334580391677005604222324058976816082610013232738640953409504682642124532541512402675879626872978255298952601427236296986002332600427632867139839888287906525153487005704692814275221675917245810486297356519581481876235886562550968563131063359684084329351801177028149689969715973735441918230610398534246823431308620993852869395604457992569092495092767575979712521322155861196322732164891122348073416072531225919062638301964767237466588253948638497852671315664566324291821531194911729045099624806653907041472963454506215698983625368032929434093900177290468868747574292726043360398776916554978387440122331926997685218480496189434992151153849098242555872299932676228989473904179097235770026950882569125128326670171194045468687985592054458833279400010648620445496737131942212434891682175392586815361032912896865366835842634270210055487625005285462320373484956015232213039263393587564047012439924964774674464357678321013904693996295929349558294657493881155482963006336291581901194920209751861354827748720010074719201669406578727529521718854117589366865282666769285497376050740108325857671112566915462070429803404503998243684803032054949460073093212660513857879482627611853174645303440494752756837195388234510366432007188278601219607812067398353859971907503777828946495413927237791154122039170534561398617834500807331685287792467160602561431237699689048125623453731183111161390559135863498430282500210834948804141843639330715683759186548860480268443489329357667367926516485657570280105473446171270296207039011257509086665763612224618728685938614087669009266479288755279592928868544704399898843873151099336800823956358107181173024892926731487016576343558614477853369710328679964878165346983674835513074042498112951481990026527776352536693052973397988658512124223583352660645144449217547828817741420042434234942157397928611260118038894563149080500020690632327395678556889225361249683323187964929052736856498595173934493472443841602271893041859247138565352002588707799033344189025285054104522198020790029799798066450520647902934661837547794350575711316311996317163455932311326912969029561426815474009354440559671009740598891918632637390810032009922211990417240880898517318350255962288387442326973944213967192442471935854744778548261433331792799273315518538659633905355627647372354814064220880863235119394522424359552387874302667871907226106195841926067374361251775698615593038426213959933071097629521763594832612838060652931811959232037079195150745475620765430913362704883512140995478943936217422256822503501720862274812408202081897795808306340384658750495579205600968045775171108970123547032234335679037048240668752793999733372620281932105967432775602318193013754417113820586676246370470000207408522993113150607672337440388105629841018026835642318402763686450289433806300738758991403725821483493668337744281724980990992358717671544026799122940995795720277790574813881635992342865710420021125755101179565262785361454978251980230377353346583812527955107958125028187280298388747454212260763838941428746427457533192781100853533140200778791984756926999366276096958704965213612535782095177317304255872878440320993402788870003010303857099259423228738282969102279561627877956465866129824710404699266546235857372722871144291432240809586694656536709016877102457077106843599052333328969036775677363259455162491482038961152988616152359546578802211639265400659428600506519562441000369933183807057586928715997213128324428518020075227946673351380006204312299621875879992012487480995440796224122615549955121261271324626653090324051582933325540754804767737827941607709774472182505233227829106709266835612205992377687519330691271132354580158188962401898195904075788703077563394764309626471213977176042759135081386855561144280100297342174853607406239170978513902882354911612490772397327665265437249322500080813991966121279387613020139124536097795151024087532181198272929746383550998891473083974624476802247117619718730489245379756715204530108327041085784368549839785781490239526537627214444993499515480815585800229350506881411636573536238553973554887557499087588949042905909445411209730102149819893274793126411843200216679048461556312759259574933453782159046663588400477999004170837265677044750008294339588577076641710142461568794241282885728869240952327588531198386365055026411516627502778769312753661444825558468533211563863675209787247816241458761515829325144839340668885619015239105067834139509536655235154301258506882449400880092522257113041499705639422425596187323979794375265348969893574085766118000498452013075482073593343116301895251817709260225255209633501906916723404748219487601460010685910211849137232597362912127163020419755326988757489059673281511228782477678521261309310206502805757037142644640709317621571874138752966904222659476283222833745985292759895429051488447771957566401047881113757110731609862582601448020177475362472807486727205884193180997941392231880580905526428935561662987485370425191439898885648753642305290740779072060303265798959886850282754177108338751354517718857915026277677404631931858511949624690000002614317719147482977522188592812403943300694072528771138891919119822068544266441978568106242301454758593677125228785034163004038972529839309862713743947124855676840683249627102955691981080965492740297733682240884579122626629031407213680236834905360860246620628261450126226589749512655389047228193193945688340441722927955885123423765336445351450086038358247009507825413290827224785795231490121567846271292316774258686161737805294322848063365353759758354327070161499952561824578914926394130664802076558265181409911366351186233684704953580915157710787204050872551399550256504084082785794436707020104487891158586898626586395877045348402716995979058784598740077786165448821789726304237171550693236814821390385173142269608382180779798086705968792558749234623539710080741129704074786353621234411155105456933834100675994041260613932160737868352891758581437044476022746337384447511700998755070544592283213959609182362560268399954511843017540369844734265056601470627380831913022673360505763234927081699847146451080827817564994559089794251563156414056675759752809472082695875150326205156827125521610539813747847544652967315309969184349734992923875998840725214479615365174384004549459875549852241896717676010804940865016621808225185059819987601980486183102535910683166431618149770929856501596883877936716529485971256499900313730487253505284765837867117662487912869851463557599810251915951352985343040578891629999235323167580923689929048465216221777881206904507211651548034616580603293307752986477035602570418984022592228261153928151296943917668346512246045780852932696921337670524735504963967580230620362907313889763378561571816408071826866857616883189832231100403122647160363930210186297125380034381402677871815293417703659679945213628105252562731582578361539700067158604053482744333994082523824604898451744076832531963084418654721537532094961455390116474890088284681758256416274819693375895653821369574367684547225006072821535831251669599604998157734414059805623497453472482867490923711343598347755529259178412281225465513686364194884622358172426505451864152868857713291234174374745882753935192307328782616262299443092104761066671068071720070714058113932460413062424258056019963771962386851272022075353623571692035915995394302153516530058922346262574230632809530852642169218020025923751737924029536049774662853713724523690008418514426583837864198957886573069093059964880779322156427471973184687247702902511806478318826648729592111487645379125407229301995605213259573991993984628091699873851218782628653597145319467333686264678228244109457947276794791361947361462370366450703065645493295069129134936057072519163405064309347221893527492174338392777767398642453348571988013184053320319841519507005428009676607683062800634018508317094889509042109256338336977540431140137055805077789350014089710570993440571719598114795529028937134151387861909165539012814435164393962376596454800464492269080099406221135413873073636472797362629389512501586480378038587268779209206871382524014018187879749416611457922897010693000742333173657419563171335772677934475611669905271669635884357453155737545137642797886783065966257548621087346165055287719285405125473611479989919213921615672525702105489855767303500740563484828152986828925954355562237198949633157144715742462009679405050331136540734899006530632022429824687148920009485867149676824152816499778214398319712079591914101679567836447151447090524306802694170242286559221291237354386379920558716305285030593490390973397776600856372931519565944735561988534686703717531991528433304818190670083431097564498114320735751902366448068527636218863652258583709388912098759758680125229139675530737603211122719873180023924049047810963108824340835912215628282089597547196666599710974408842079258693054858166661342916253623660972472381659489696063386552412139273368852817757116261696368600049160444231294405563024029587716091274633498125489053579302846369424359764203710367178247965969516490862517831499169930924607177604594360205641280047354107993636153409363461296936355406106226890658312552299828565599105753367775012428991720497147438135380211103671302484006975719812717187512595171197262949944893169457946556490983526919085382572344886819279159218412463776401369314558441701691289910610290964451586375722305734939632569504142172046052065780706356109598108086843669521712520635661258844134895723499275398284563648744983686123275254840200200714613590812778748234476090468053468420550446507913281422465568016391928516785168343967059641115311645129199984150747250455823275269860572352317935362874465620086320030372669791207775137694815170472469182094575337788727678155298280235056077784490494422348497471840806872792352158249604852318580736836007970849822630274764499489582755208947745389051450069672804454501437596970869824122829315204942123192580896273339267868529007125757528222321968689786847517732076554315735388105324500155905494875134804858609276979791047466902093907606351208057641040092165416139067989166691929499892612115471108875021759717590253058826309673263612430171052202434573572815886430920755624703420775370574738370832357607014771245061671772409351192113137687892386250129462289761220851969094868847417015032245686346609043305137971979760719262576034299475720954219210716762918832263023332573734339180143769843411276753720990695352864129124112370343166141917314122599538796403413770138038357495236942144490334705225918596183744430682517812557628596462109086086783873606217835331704719591076494013254208316583523117765221713031232474540575759490592268749918031800970325272768657606947671099862289853013170202091000421393917911748885649069208954176864952776283738641707198992546349396545958447308954325525321576466595135467177539628230545198569643552690546539496990652143858046490826719429169276314400400751339738993725095119489229333514710951460558570801551460011601745945840423122756492753325842159016677107623778946245950132969143760691403761765723526845276727311532033947989722528975326160385066842376152417713645280064997583264840049865995776949748695572617122809679782349085103209510923561284168719020997330238656751255355649910011584828807269707534783995462904940512302080203558629395762712305596032158624505805104547656541630761222074622045235552497114958795567825542509961395000352077341762897883778777469734277588643868849554450775538380454160150062230686452957716059331710640762194486688111701120331313851497144208899728634639057844477076912908088786912631008716180384098714199934331690125263506107167698170868526622198698518304843238213250633149239930094482120986063360808951829929998943690642068339497944824995243086577166773041214646422576450059839461816224139008460837614081036502653715290040469847561237767574351523371134722937786505443749944873116812590325570295945843040855283998596734902438842000943398466230271086133390324464111734868837478527227785128257310852221890408996672876674978267755251617049155844521005135894287393653851166323943632025884792139583389941095962430443723950636639284177901013570594539155598338785847036816624425225091492382804352348624209671410613538425793460135984097647820521105891434048754729491219976378848387425106715613976397477919530228751201530926904477550053000406972589636884465334842094507327937941967582974284017014886424525010486151041381911378638807386170608624908263641646039128140258701548015923194064222823915824422629080493160204998923140684380473471510168099515453572138800169824383729743998159303109781471757683662503352777279458460585886665878417629828644465719019267989230743022335278356090802395502001868294463797388626752699495825480431919699668416211755540425827267184464820232065341556915746825852701253971045332387308665938131939972356608874946190099874442992174502843853679220175897506189120957804169447027857803005763879723312192709805911014296155016016580176672771726074830535937816042482563423670260481747145776192501037082217683002257346791781910940533474989091369637305082672775619863713192078512072162194279839271934557968248206305358645761408263040866047371916241012747330013020804621143842022669916241900438482483409163813022272556501494306323417046309712471115125392317126924765029484019844505692836410603973369722093762147812690384712229313082887696882604099209728849292509944365873142144436436472753863421006547473565115194851959076251760034767646967801431519932777945300754336130567698644235125930348706862227361181525523356054167550796123438437986496206026232107673193273286032179226922839002648129165022175893560597003205885240220540239620692447219984612239175101074372415911031364392521933944136438265957170301038570282724779610602088164107103136481302297447443969311746906565991264300158937730415059788654504505571829975566304248942723279108213780341324406461758219538013972038200055563353399273832055770327302392905132972732715251443900054938238149764774076093059904390442452926918886185969090601428075077186281415229610416687722029314023052792044526197403701196187889751877482066146674133906537308009574297176808743140321332464858689533162531353428210028126117664465825435525304733453481888642130595412008854293643791215703393468479798454136318367913172596593149315170031139675353675125192341176647224569282733827247056890949246375452847499238549871645337105485522019315577895742984314050951967480202676801040256190088051853774294723279882643950428581607452633205022521918325576613764134080696809719872721658451056267867290429057460688211975803678297517112304417953320054471319236413481287132642917490178322983989385580317072570983718493492798821250303191704001217503965657038660292227173731275299852208103268368886861076385732255634169703296178972699546336530969858247226559644591683744067612660102865162087345050397271452795720427099022714940871654708995962000811399221330123653031889790830946309219161370800313875798108791054818843636857927337163916910888957282271596025454080893127431499153132098437746538346557417073956869174686385052998333121589549139527255931164359742253115150617897073998523270698884589101010604206184407311447057062928873404927194134837735142449544137123977210027074664746092082480682699897215224297496500763629298962836388803617708625889107375402022311451484845626574714094647347689370833108732063895734595416373507540653722177330733999489510064095224957861118842325568809969797648729330799409129611385561109764827788383201293963673510367740550944342928071984914113791134165596982775937467756728981529013463230566110166795489023686189711579576722217089429345045053095069331388876342668753423225174985759902924548390285547473670665437602057083109017405121657658892829505573112128384837218906326513145143101844525296674018044945557805928748110324965492761803746810368455381537383503573348545768258953437903744037385769817458835384175689411735226896366469740850723704528492670202549976492542072537329215958769442005369765527309542815931678927308589597221199543527984100776657757062122027576875487842700327764711252112906751414591931378739642429111932824685650406664091060246875602857005853018693566456728896346149611925152940210054642770778980312319912378019452988686736663899558432654215031951023471442702967574563120529409569525681448494809194220423918876162052972498096572949625049710482633206981814906531078648659260287529618046034724583718616447654485061197555673963085375029550094402253893012911972968450761323146017449785599043335740762008857005653498823690420444833373245242248795848002710587526676767977489421146206173790607066306758645759059984530705989151360766397460280676179807500071744556726952943951160884311667976251556711410511332492216233976400909550312596711766773601908605823922885819903486933177765702577149420802109494356394505077818055211690750356234707447700560014645810957702382627498127723877418515971657212573114997879471468930297390081752597101261365027792283440585998733336076672886055497482515471596737057063780859412458798302810381494904793852712976765687579057502670771278468090558648338644768107996810723830209362163247457619072289893956904376689250474495605553456125498142711201453877582055984826065818563429929470998565423086455055129267729661904714893305568565738808601185158971554757179353456466555592147373840023330010367976760995026217231147346061179607035109887068345730673321829936174475026524531672212253568801384809222972124854603234836809780074021944967169986720520149868352928517825848592141130393368372971082329979421733935886654476965931381621812410359980328095869345924708126310236338426964145760921877660847518211092385281479822432296935352718771891621123247542801469419497579239964243552039473995617330198838216590947845029094123493060007926831243577131645350854495100862277777649908043870639880466737427570562770500899900170818950542298734309502436384927876461157860825397242877502173206665837875493246156507692397121811055485862770406957657697294388799932042279137833000223466855955120168644600753055658967942714793412744414068557092421872922185856073343179595313937851187694428090498805930421136757904616701384332809117241401457807150244658433785903195087237371722459052586206214007772461425305274108163984548710517542039856315868266347872454678685139843806891746987459686379506999542580776817632679861209243097389600802521541427811667303471210925685566166415990910092446063437769888403063620021357186756858885407031505004324545461051795419418080347494321971530991698623107789002021357644876960185654511602655824262775060096685639382077412444787931034114285436416752514556290185529274681148172809148287863831770752282616061308806933993001145970718140402475262960483876865858585386714776554679047401454567819353726079158358584174935037102198880366639024323921138547684907679006040322424520987789942772536607356153935412942662230031110325928326959334095108185239649526732142733359047662020673792341137615392968389470740816206397810394095677795985809341852845089574253899157234224278948148438359004327136587195306067827730874963483166320874624049688582036386032899416753695332166642670461842585747537206638349962643018917005639375363280920863145230224670101721679967542984802633557148052318799279852303574551740415595828981524892665063645994131944180616358518192669848381182621283550029312807771489993266366162587043805289485007125260514729731051457280923799175128376159517449599627898730126123531491688173997541209352921357582933546160809746489914008932925015395186388127096445640093015420930762904834502776879118748611325398452793971922659193374744111270146394812366274863732612595702101742138209357107847322471454492424498185679937516309356116335277179420812967392609006930747060394821818228072637480961810859596851795771760857222106430474257724409932436595191695191002440969184952557950102362774129426964311221406833799408594579010453694466599700404598029748309649533539134494625361204370865997412688814365448341978104954077891828534168258696274660407099586438116718574313014354457554621559584608416300273444539902066532349508869521881242537133824793808696403862116233868542493491118633089907074794739746452847977731277704795018800590332173981225225801954377819624497579723090267288883632487300987907690280247773423718670760485523050037200988582652802143210745744490084918829842536191617478200038778172706921293859604219176164728111900341106171993557990506760734244597057246455392620648573452515843661245199421581528029442397433368900996482835534144716572144359814117362703799470653181408381144301021428126889262010876489189805745420470167295157896802419996233732753482424736978768912808859388306148158118479843748283020854062850713440176721091800236656048471373340931422105497898107175084143430700748316495790629933783821732122379231966376014545954970226644983979461226436003131720202355114339919358196689668480735625711381499803813698765824661660388253577470719937595122946217704398221173341198723522528106857638148901668825797153063683706201725804905933840862998478910171522063453617654783970731630135940927945451530940520859345178929571952152335369349597041037958315207429835380054075890400370408859669721868268520935586351796461353520660352002034001839620691318794744748334902175484362352011210012367438509309551173309429296807808578984738298798765061800901664559643976696692919133815784643015784895058388242749993277205820976346970830837825790034639359173153174703892743542744557150200624352713728702579482057140451739165903823829882710647210051956999297440536162365134727766707541346242591569892426381682586041223164929118206958899705407157478558515483054089948818693005004153402590212182524342492748690360382054064563068315312172391093814502355724250698553107689952415394006614332509416056601752495642910084447481456447336635403595371631904867730449502080166942811553017688983136865107652064646276380625171926507242207754840046417978774198352534526993924754579018341442285259111561662821445464702902684698386602409579982292387366322331401422968003055473543916396706345221783933341124060207740159175351766804597032461638166714360863832875479572804138429683341374566834950076643866939612829846700811427866204710367412116461023126334121100820322236382770445868466759002082976648130129490590672194947978782617030050627734510633040091946906484651548732021295738119020600659577606462630175495364363937583958503375409709280066841978687936717972518914974932902205336130778720112238284112416877396959874723779228968437200401381846396904835137886083155722591947591071330997646773720520796138603863619225157523146433584689509181625211370585819969316199803319796549226036612375601201264477126372203756307148101600474300409545756968949032914346442013458418882617922296585416890127099486425218823698661003598158309477217487036454284890779780468778796576932948907180957274729365910539204048090616500753075402740141338248869139753124799395042617006032141833130456649397028295528418785161096336681125244165860198788273948292656379671254743340554983843966857053775278390566464854286651596854424008637557751094593635339363473565119221970438065475198074288709029312446525083841767514866092325509558228859397119351828193611090047948965449168098581703141451627800421263360273328566602880355774050534551532197825688383281520823613747049687550354376631605108576287293401499935055662321931925789650796022428084131003553666328004925878902560152188233382180842302666432804561256433515979234985952908668165338027644042973690666825141377062504044522179651697315946323357916832136148889806845991683042713745361826907869522033254111537101317258639985283436996188251358786552359558286484241128528649145397636812158651577262335626238119477303754018065868850971208155913129967928712154251938600531262386690112613561007452310388715734187781490356339855829361657628687184293149253219588407594593886886964164886226864669441006468628914822986360220362338064450359858552487176471295421276894457176810649752571249130123027707901237761501141951798409512824348830262991526283948995763425483706329828973136031230370675858508751284406676064362022924103784671858815390258825764906182928329900348216991062749224060046579142369716068156285419499658199270736691263083555855586587929661899009684289152421201904476821220724127227929849753423899047591726381883890117694350998872313231262414043816838289097885538496655769117312044186110063299597821699982882434672641115483271640259681996323025940244178408776762476644524432501794876539115490839369977058546867372985485615518156175043920451463261157960053724099843899205645231682747170325948639635774375443999437460506529252984779390029054832129934556870983299057533935922761458407519668694998854492403254712912980966261903615814072987495340450167362322095712886616466288741751860639205948406916622504820083976682145281856979169162072024823292394150892829024405919561185553172765085328354399237578870849751088309081208899069132298546824887930999444059771565875808122094728349007758605405178611484267966308058164007336483385108388064827696083583734573367655892142170060664063309811306366353870689054253394703805033673563624593955932851722093088935905672326896082394080725748567026116124416299737962194820461385052006242150752981446364569540640827713522134927121887085440584035891780501980081200177239037580203239928772995169213427788845922318701443860933050467688655394227845375337879826087230758860813236222335347868916036777099066853683184588460457335404074626421957505686827270669345340776672540942205392769995253760229696148856793218117679165437307345959113659941634699058955378759643782848994426272211540696431750869001319967682519569756032812253006122796921926603450192726908793345412590736305624668844282783348418049249885440675637080640712904814432477501901378076768365275452288135250087696816588628098089942381193801397133939453241502063247022838792293079273752440424301368819515008841534952208321386285531876683147977319895152768367404190791881551180739329504533136786797288483451184926198948849227414057300609797693479946310282017096784296628110558175562720826316921863144265466358365033639035474667526396629380827205395696884373012587695439264504535183478935452987494397328482611400284038447457442228086921748232810404761648660516634698316720135464686354324528649679272685679724855783535568746145241077220925415523608358343977874062111203319025922404096148099262660416525274848170598994283713914151268017266427609425911190944752876529334858250515651867204503511020903461056724861957251011247494805207174431409494447403602776619630457419023090736500027223907725180908060141226647388665520972635282636449454854543445031417126571851343845850198674801385559801935607921424798047159130433188607992774256519671286382966951897232729217563252561572018250899531036290607747396029811747844117301759624894090523336141067416817981347810151023842194790161359927788312617102333498911906109099570649603441502640366036941102100453466105236417784766733122292903726717772461574515010608127409456517020667773796976548339199324024816665359793102851676214498622879352758647354068150472937974567755371254685313033803001513116887881087590792962375311231570654691426138280576928689314109061672599291574091394001775450490070400035118089494705137098399283067839465387256510310147058793252879033942008145870209886414410607022651453526581439760134046790500000264564351196145711108983296765578559287587942508171507099747057073715291412245955764333340762366336385624816690566667709202201963844909939574708931609724868177955770351085342487802999728974750974560715597821075654370968694804485239622519938209014774363383746049218779476075733003511424781454222584551635455896387746042881785139107913343458386801074542191261146164771960328990561484773093265832813187848234159814426126162870822373762802394974212748141624980529683963853555858259232251254763354621387350225451489984580432510861595206368727449369268510442718949776944783099339046689129442790964713181780618210071296867005010801950937535659496869337261874396067254774829190172682522180439426695728171765419477594415434615758841750991653331826753934395752945015417959558259219668518633261778305991205454000907502446995357562034072977585158643643995464630827036882055459858230456281338400264610238743014855908624829273464536332771877026722164509114992009566745035079169131077297559819143753186065608045159293427627961705300779043372791542182964434610253420812871782079572841025811672539316223962192281008933296284544730215333206886512621147982711632075598099485990128938018790160103307114159349161508806371902578871554646210463375225266016916457425623092537304807150920374596782478360397358428810457699929640833158824318009797310692045130135007821525986039712737509069459944361563196081964265208135337747481306459729641833984875031617169238056711564203994906717999519483713627162941339827139646322925061793901761291534476139577318604300940837501429518601455075496772445233577505468358127113886428559057874968178881139205891747868175455941992488843316693150028349141490593918001761672054896854507106747984954038808638924878974265400290964636775819400043110408354415060127147841863785838998530896150819847590155025728494824498473741015317005776992949613366688252590747357093812295219631942190176754135151495256365335450697846710759138218987149610951772654181683662348888053803414071424717208142950179555824423278676757338644157127091862135273877259809980468443714848510876088970580126748723096638218383678658309373525311448400560419302495672037263168868112340973217876535075189463490382921034837285151688190476614161365435032516781664674142690181816384774392830342426340006540363072146852953219034360320330817149093270533326269214975339574129673605020818085450054056931433855643713617594772670198038498019422433578423138805328708318293383163359255979865487445143222141817740386201301915095546290052221273200046534802136052352999988405142894772166857571862317760182643925030277674245281296836021276442933591548742128785017352670362304970452095766022707596689337845695312016357671603220365207481215510240898828671666495923462786732032303701818387303662071032631128355811303151115516169601624147441293864291931518813103434033858008905432272484649563119287976857289493353512413106067151149350248081095121937288957890874430576054011057795945908611173987383213973005909157309284763048671972098157111883538999484165033164457060704995128889861244336018878091082383745156112600649060633905016177827976362445716545857067737670174039624934091805127776936783916344370935299707110649991928809522172691333872392779557321891470060844274110374276807916439921883927327926889561873180710169089908080427809831873540612484839841148744154343747007080646999345924812175572259292448735845268276426740780129290200032070845779060918906648168298807249738196920683571880062939066963278832023824354750693409373882278935864436962413677414711946348498857840703875389711014125994532906578476761228493624045943660929040882370084119329946803225910131201922562700761423455988239085799794154497767416110357679922424551179721087157395535082765006743784121704809198197125835940882699419131479898018085160607480813387368944188283460689412802781042916259026737344446942214418922809966727897918913127328214479619350223275217675800276907383234795526577916967500077027134937832592518461760002432837721724586686111074315394135995631258148919498988034376673850594808834416747861595788570583659243473100767065117075366960591604070309874819475000702964303236682705140599826672549193926888374525488438476956864220886918128987826467314214058937427368702527305327744367949581125363644810932261279202088245286491855783624667510415184746558517793090969829786778353990726611240361141150563218472748427386864542670747528315913145737500913560410920309977596762227528816898678603610202084407786998048038471008368046132502565872283477560069552855151606650787378157130999452999760973598097031042432994558608093585077418643662920379830562880402296096316926359115463039877678192685883869309152533100670853558711093366418713609109879788991105440714586948997805936889482624618777667177113932935065724937883847110852732758425551594353557702722474922387026370108427574404591180941682756794871645221585501289254409509653441893730807803084126993848154924831357748203527524378033681523320618185797023493556657483763423862992738589775506370840754923048598004463792704278942087377139621297896329563742153144162982961088645304770122829015087755585896506531096678204514922009234778885525493745148556515250357314462480623021273125954351154445181723423351419890157245556888650217679975617449058373017692103738192914393585794209766894214622637641049981703104054172952846004652573809107021568909991722911741068975713672510328117489032251378349534865572963300988181975720620111971684694823553755459401541041223200552817096582142657579079908888259355393528326984707195354288565384106490140177180347593467479008654755329829714295475123274512226669714871353727089820488790769678275910470128706996976496767454825544022825043869971894383106170037652167664881750000915951179167414774350406673241120200777103043160107007658399467368652147256678385953216613763626594782187901293562031046311041513883764102271353743673882779993001798634724492301351919247165076109392851563996755632137877676267186725875126439697010477283618907937615437150734971274187716018376952537829432432443653742716371107233326238655428019626965745372700810157339363404781938251936658634417545877829425707123861135501516703735872694019463251816416190967642208459782476460976360990733813493156616384896304068753536480334658608696595858000664005866403591135504216776708745038796261309091025343097130223026139342247209988325829454018844504273842465304670832927576962456229049642076161846661146541883190501482686135139119163715451080436616699092793801292401006395704745442746502051042127696993825775196813833484105495967911272440509437142591263793135946530384839406290727115944676382286870563745846275217191165480521191562998678337918055135436971597425918805014870034927604576220988989714977716902693411848221752382213692964947605050928661617873401779974848756280474876137031649437528075531563830546779218938917695198854998074639873415891098831536954863850044924435612380545972776875858630741390754497081844845834683648303698744527415150142531966068472200656844581700530820534052507224058504048906988538404551696687982530405925284654900691243813487702535514033601337069124308639769833932623551647232816663388286240808661005448679589324290755468932529301488917024181240156939112508522229934821165342713912224185088633101207606120902246175646704133356508119382311959896016756304156368728862834393967543342374275087800632872753941719627599496705667260441325669546764011815119627173312257645056766039668623146685630552203912019630743020840232529322523018512186162492812405052478953212733821225126505150766797668140979047195697556729469029940640607962630366014366357248254215410010519357345254809490838676247258541396962131608125348350397152902640825246875960538731156551664753229136898657434077949627452546560907855181700366719201727405404562318632217415677551897490690643383783818008425737667246223012981652660597147290754333510508101825722927845956882838927148447182501635789854736410074090017150680482629770996914637298131530037690967193778499971926594148655642160848773110806181728406731377204977917991390189272572896605004954844882813545346194319707691868792978968824471535808850545650647665015990899206271691990911718201256461335761807737694552616337059806673162850640135267971010990626937256506529779259098633094218205690989018614551500123769329584073412088865317697105896559552823039941319002437126905386102917417840471763498826107825318900808219462139302819948283492811879610261187747744427751897578238199064920754624461572114957226288967947294468007355833621573926555650112132469366235194951251080233104406189619417945467949551739867771379643983830376948941639810698479420000891197582791991234369267421883562918458021956846078211254278226959128795180641853543597049891539116770658780750568130831240658237042337253043010916345278508194201611555423982016417022139857647111239646968857183820755585252649427431495944348865563801418022717708360708072952594549878296953274107457646539754205343029092440334370913391140566990604005803038285288750730585435823100854553011626565981294115699487541014684784578158896356536147965874508966968821598027892302309516015111737529350951306419311462249250633281258284978755027854388989435990654280496864994640476127839061918240765884091584186123531332759069433258463058990900627903472283171992506110284195693271268320989083842190562267967074750677006479509804405071822620845127541344437294813096065166451072679520374017476989890615156196816287723235855975465254294351757064406442370058280285625152897020192691222344768632483464868932326619077212661444692931903100888110630509969455645482454211292293212488930612289178777402758951939860252094470021622882885299161638585420573778500489105658712901584398161196129162427938878048606968707430002073239159003507890802137256271557954370258648481618403418561922434118209759217551453252211109680727235619001985024243970879485911871284399264719094243963717186111088200480686055894313840528108350195565640361460880807799847650586895870060176745379219072520880796141710421567801520275449931127229805262772562581426090849469576657839666495976292804055029455336779695468409642179381677025355038078062670258135570882348663825651538421285619479379360142489368362591703520947759605221501268603789233023601639979298728295583642316050629998705389588564029831528953634659189735236278588184789466027390071945644452500162705203312310616565739082976089071013053539255771567916430557930904936504310622265403109594501646270073614360365035643401473577300084429329397926769694295528071011104087731842050387728423743504766625568724961511746715896933572405989638372473047996613108844193544106592481740962297938195390541692218374996696202634443243535924828349638662879219915775605613153031806045040089717422368768689950234137353712814908627484768906113896055657969509528721443803897149322120427458352322651528597987700100200554599253599956376234583268218389785253022109353574741661279577622946720232347139781140157770984974091782513714019065516142633391292323359064222234867209727206096940420445247322381596072164216637989091027667841312925430012576378536937921408804841031109482500967362150906109437446230277217978679936929725376407902236530598638136526296629352418752252916606946266853289534023127216445573053196195670384639168723934261960452023545977803217170907654055539469087250439607248355379616869412136069069087339000525214725290154630816987567228530295392693892653342294852927279320815325581844252805739451957522544613650711892025810029989389840072783656312343094762720906926800460788409196103457742027790029049843868666966035199205538075288884129775226391029231609467960688403265772728507930508760717929323672891577633114364037706252499998654380463161132058822223088594431019439425162306530762020776972672849858682077235213847432456833443134999680762276331331395101608851355963192729252152895150531216210234029522363405940183185929728951361426770163319525368791737944637156208137617084454672281643498557069891164125872732058400509738373361153904089068712770429027191835468023619104643731363346999870491284650009041991456449564157622241116582857349435719864125088264197777069275885571875155049122885127138155088949966519710375021468357457822472600222104287892746418529640179186944215729947927525928487365405955629665415646946423457534335472445192050902045356422841348882155064834856980150037798173753173190480390989745863329888974904379330729670052459062625818023241463373474213703628285329106276149874755277826954649604843557065865053145351063747032093160160858950283465599499599144177608963060661894971609014738863347768838736422982110952202506570753312018357612270470901243165457504810432252997329441184256651259094087080199823566857224990012201991883260612495530633483512529043371101467499617765620557294490096927151430787199107200487919956833683355236333299764771364670750574961695285511782234451371993455587557090014302541729890222019876352321686752374934591588943986933756325575698937229156600236420749735605747508871137864138123272662819438880164179779241185225785732143916019111020714609231935939838274850913209859249413268343139550017028125150042729665592279624050351360740124189483160597690565607648353429088371803215322515752783223239274752705016426703183989529223169063250289105189432373430589776890162183931456194699385932375400015311545363868539034916513745992275129549226650393258820411389267597653061292998737028430959535956922620243263931747111194524925354475026904312259442048567952607203386823069741414429072210576129209486897339314543051106272898023108574133685597533390233957258782166120397350711581234825448733633451723315198445974182375586004376865097751495310182077987695533702569082213399242648551479975483866003401541691054947636855936874631983394958107515511522236252480006406358517956972106356408816066856635564951759705444425726371169204705940661738920737519134619189148939138792866658292881111840671948833104505376485303831774360248797605917056742033559914496826481173124198679507532293275188975004898618093933766286847136903867518562713454883132093969731701727657729705629071406336170743225374533428683230059832544893294336584976122799511590610545091123498961753779356478414893330275792335245911352829879824124527309989130683272153289418102725342653360308964351375550669545319556299391766883067967753978505421193395258172258582382959532440786938819407437820123545857092828858682523912340982795379794241187472330976980545184817261690770857192150835798988968670249821750522623882029669147289595993543064141841526717743661162136256151300470781602281535903805247894329929077849335744310307891978987532314643865905259497097190094892979013819866899693169420107159770019098888688698491618623068236666982828921611977317754052446443462786738898133934656391429200746585127568347252556884577000795964352527302213896216676151982310291233857426407625111937559600650081024562151663609194036807240304338527621208525551218773549341234485898704743016582140559127250484630470837143751611916212872750349859602913290457571802488912672898516064652940425822194472565514906054377663128347813923897040503843354466358753447339475689663383631359099058168167479993353654008370167575681868636608497813347178060377305667354470332279482913228237363588663289425822832391780680289426315204848784003386883632888102250764803584525193598423773901341191230644973906184004966723932681257371314526415841410538980360201418904664954323760789206807521639622126403102248289214285925513378292691843873593888343332259414215551867593899124838183150157827186614459640572434663032959657027722687490861379146995070915720918610394636879368548608736915270508432682933622477460808389399926027916692002749485703283374727333284169764712845375306537634626927843707486290787755845322154044860060248556979434612473586322730146560463012092640504606604211820223238151322768815127924057294174822395865092323668773639117245484379507981671543852741852945391147400918161186012109672281485051991649900387635126242840221662816618154618911210909819740351624342032589666575775472886575928015149180977963004463623262232393850263969976619363807742786014211544779584867713864502783371702951116179309473428682745200373730814625079943561803289237179314797312995271621610286263798228321557264911104913464720653670689337258696444059690844871166375157765110081635010790506159025399543101838535202635508886602821488534332771319190233387963874079385431690527162428036424649659981509647094357657787061910724718545169959391877967185331175480139419294325361860920024549906697580776340486012926734665063764202435639773157819310591066825121003826950421011569722445588353242999735440380211691944093699706600602835679262148838661871763077876259384255402885503206698332691998817821616244870827888101414480683611457237611740791037604033379575367394289333810094917556950868526899924216557281392051461004537474261254112181132853041988261721117597103652702010326842845108092044165990328402813297706998182615792790787456912647014913919049774589715085888648678693041253613427983561932917420541172095960090240286923281910430366731077128709717376617231004058731723328999613625475915524471384479271275231350363653310770948920360354239200786945652252039198725960845039179256071178498960306674077520499328928379323274945915777974166753420542534669472635370107245095377417167221567555745383990213198633505570934882619840637789224179294197708473513239702161862113434910178412867675344356077109599844015503456165100848073288353478453159485044142949664851638267062408479672783440575404782005204224991964196845106169942684918538991734885506794940929184074348742306405853262063161994436740869330640014176110319264588480089200288496838604836948508446265506849803051768457956785245944268944041359218102453989972468013820646850635698179117977152504814323075280684740555974006351590565782326437637045818615398970506971420224505844335340568871562314079873637234942976568367482637583435926708343927693551110694398900114661664844411069808965839559076768403451985092";
			c = "63891395719245439026787411411343662354914970113937588617545133841022447135512371943939458210241058092534696637374317449478632028320377185791313193886749485399324159763022131325094048178332283668132192136635909153780285494582722943304042174646803522219039608168225628660632557471280999647541269417834926614288203253361131389674871322490601050258208973856186815544452459626866171164200102211568809995442311055122574498952416345751533681101865636773377742810914698548282043916930010393445219803497524254204939205779452378176625501446606444312412464149316603418729346621025203147766666159931809761830525846195557627725088770813019898626149566869306102238108363231069207420617824730817038825997674664388089536853818013249410346939151347963768147165706996735009591606406048549321012870058179717447932642127908778586507857309549025143574063671573700722620074165905918618843039480532179237727952959406364549200016683479605875565884613293511250269322623420845250067065238416829582325475804857449439923697463863879645203262578610470848361310752353758943519114851482561692230578880055514089552888706520819785639437761704371589599241595151002331842253048280899327995013635056135169032175749250213318629658942696549080151567689400497456652824782547101686962465958123423238677851963231737558454196726357817761915508593126458543394073946656739173529023396194355021861284938670988410851943983557954920425055216321123057721822670427387778099274255558091488126374975137931919487773345198409911200575435755126751452635488345921763422036449176696100809926202804045093255342196741602695932269887557403306601670210285863119294908060247220508463333594540025048673910449266215136056064504608435290002525921520600051549984188047337474311530679814062959706341339541190252178332466871894366627192132871372433955838680938837009922794838840005911468103160953775987807717801789891097217892291205679879270100930911819840608932223471432968802810010277120485439170096751807040588472042045282752058666983307689667903535730016001112923830350058218444885772826187942929549654504705484979855843376048060534959539012544018689019404417839311236613730550296294195871344541687624087720521735895135523895305679288946110620628763378013873302706694067168643061840821119171532132167960584925361081037635962803819000167873552112622470725422426995401195467827872520459689319936099287310096427842015219863251604086197389098796870628445380429490477791412501266688804536513130341819085224054161510019506371610658383168644375927639887784385259482368134370119053267843422030489613128078527813702815052667791104749340713323770745171308873455458111917973420575975826483067176419705989290097219700938311108248280851588928988531413824569455468484459542585658144941441218964361968322640670442979408277070369615533120048439084726157210432253742141784372922149759835881219991934749398650386963433583100836108283932187086754060699019079639141073750081684832178447222676457562991054603429695037870363981356562259466208092958583769441013648846441849397100829769726455359527820627843869390696388652278601120450045624521059683210978209095776389869282936395169835972039954093779778439439175607519049435191990654593763661241306738202838007010921864801030286494456880101242534423718444727318123152025569256746904477320792683162384690623245377345365512498600437106657308055878891624143297688949220932324729507802838963838079793410751257349031805627506349124209682825182830962418167500926690274242817044584814149679664014976037157558801799815639594022028103353683834932772890081427600108489741181348938435261864107463497499650201902534681890339721527712329353725162760146043635532040494453671952640168807328111941228083510527046020982727000678610051986329606606746656524366122846251473929070423349425006561074774815183092780024912035705377328056800978418472077146908186459652484827552446610261427992286831149216515825207223106445279164984071051508518710492218453070609310954130781104165270478083128971285205250654966130147799573649648644998428197517254404212690216986982766525769235376702730840542556929143880960876299519835501436993616759161816670114955798708404217060103800277027313596010969433122789306357920813313984839717587087822762149270043155907034597060377071036736411412167139063320894670873627073549909505617332284270589810621652159594894219540004296832945028711799324497610579461300181575457546367700475096970283132297852145455603827372838339643468502203211460664177120690961745727427167532101440916066105774642197192373188561523948543339298772622107620205466430718921743637362800202333989105036299882005980619088287108992597679420538169320785015250342704537669098928702013952306743993755478796044801274825625618959546833222884608420238459724445579926479510588038355683264051909469815440269471039602720327312347233688472398818854234827607907063921609289461591024894316722182664046217203158911518136539112438314076605214233829189790807339752800955377823767901111104461490685186426834203435926216961464773939312676527924188963906734067544895426594162371416359093020372749325253684599617905543194795240211794479832394284140013156319520846228672214245970127971054846012078219826326797857746204028890462264340482127731452364222126785624233088260405105131074071305357984868862523655274273311388364954589177140688534677025183773211095647439526844003546830951732328100322983015585292694136161035108679372190270982560009881601308871120457898030942186033537211078786041752063421228187127106775453115524251307908840223892939751884508071875684194938652154122806863480401236778596781089099798888259408201284315945956544360076397536849483464795095037872528953863996700184306373066313289319710929424836000210676911484718797756304207861288283081545264410601637054286226133282370761825922616621088936802813542634698009413421855771286138066436165277675788726321529545400158723705851853852086324790086411758130653232747429396262379436016511385379503371400719083048722257879506211279183308873081588557421807265734611724013813965886821811849414548154711094974484191834577959756879380232241872119414216961743731531619302890783459294064777307778853056350503581481617851105769034131089750326294182143230088705688540749628929476244198762094404392045503067881805949068097619563459122558618284398527035662660372286318463489109686268685559480697975927845277913016793831802641605821944112555433889132573244738450983106575348828304603124170876492768941771260739387113106617365482227127599036222330357954199960005316039436897178262728254251387065524175882230125580276427212192964487360371628197212837312032689558620013760732655466542808163217533594368671711569166741467560094053153920759108770653583063915735048360577819094137572094786937666195959920966480921223286882717300230388586351542316407730920580654302567610690349596309296183486588218235232479712106589702599331368985987957443555323203916015849752458601340856163374415297342119061146183177865610680220180205565869889167898799200590057478374656808761910644117529031673835798360942929877068919390807033506278755440729365931048669054046025756571376250734880872893920285663743670350426532602299300457644717207552658198460668334164246609858446601361149974095641597272605517809063490310200982243039774901569417010510447108160723244309139684922315591937982331971345548324152900654770195147439788447817760091881036446066845718131992596506644440490063243503165520948024689812197111266438975980086233449170089581718318931117309279553209671995839653866833623932690249706151055209080435794277491001799044085216872697815811210751733897748655380894256052199900533903118308506543290201131263740174431270252629403372471967722165421191115103656982334630762184222966638229774178598855528273279614838567845306963515208519853515825061262758170504169394922318427935388420191912011354853501038093514499704653178334408415076202194594362964880374512916928595366577029107898979158099249911865964131067116306387911240808484776695969070505478400253784712089721984308776532000340728287586184590310724815320113553197179358871431399544151214628735251991786515653838149736930094713015168127814071077379169210510559715951909273790662644302570822006313679482261388158342868467539476946043232034321620720936953142547916764357890490035320352492086047524333838791790153918154178035130367303959026693900376766699547862096001975672556480418036407054222870477794544866927230667423260514280765322169910228780479671999325431292835736346056976687957315746300407652282613044749724304769976588063528724234116209225528061977588274942051115229552249029512665015621406396317867068903427642403247750658842434704993290154793362777345822117163262407287169325809481885872422053459187407691340414735344546810428129735423790138026409574360455570597413303104541857410170386908538731795835474807069681596761031425837695720051519173672283272022058179838317071771148704454612517752158818873421892427557029048472336578054005025051853636692869059573886061886538988746052502403410087614855028932774921827082377155831438662860621957966829605822681950495466030210003382440704693471539194305754336753101145792844513179852724830932273723379489615372103500545035372396636993166967136570116470803012528604765956543233206930066191015797045824273194638733703264714827776603118460919993641427411880240544831846301154573216129698276525215875147816237923778460515062596773829199949942848137654847321645116263580656874611207891072041326716094942742544959831975243813931777320903265876553302017134840765758325751383882212299060055090539881924627665718128148700395912183839686871757396711723937149842281157261505379656131267548108809032140511295936305202538509531695037155109799912157977774455395047236482352208337715306792159776336627760989189945319574582972921236646366895340008909389984924886587316463634855082907221785822664045990706361603768939007261405723740619320734003664048596332570924155411145482430957614586118845844775076334305351272961470083679698274423358251741593336130694188976106921958587867573604725755372580354771057075844139217185741119328314570007912016101140328109912823811147747262213621275240059581512309417378004445635841933097848468585678614266258122582362732575747978926546012568772706686791421149551178747723559804404605103057661213090935612291912041422062076915720432334801822716519357408798096412841720239675054312216599442227880364816171955184581364587068484026019509229852246481706849622330519712453845288464259758938865374680017198992056265628537779903553162668624900147141411165458677970759348076996163582891726916182683757799872294617061998137857034789235519730032338997889987696478856921444098318248287013819071962633559590880798672968758508255881429951920533688315121884327052314160274766017121577176538175854408556299481639483782767100150984052890130698618266060727787171487053565963037953868712464575950849695839778157927560689897294667958914582604271999986650389528665740183538985251460632847794392008437682630011691485620713459563123714074983009543557710781722665111743965756628384775614499513257948087957333418390301938400115095402516165670530526360930425537667128555095746738391260690790360337312769978884502154012009455181765938581010975445112489473341305448032239884147916461384984381322060670039925660157702581456841260129472491297520721167589194329747653776326656983902114127486816629011997553274259606267092186545087973894774756563514749599551081220172867843633505564234550067257930495727477680061748205827857435329082418605754488384972814002488775673298632356508933650366075408593041683359152432047134206260746872870462351826002403187446736934668853019376595143570240348960199772021964427822409350357971536270437473628171885751399041361133622446832945348296834888108299544737160814611645381734699759070676353600757938131529401214669406840935462234773318901123191728383832893612495482119866305835637105699877310012476870458828540106689461918867313256904568808516660011983460742419861733568218807796668942716298803441380148163768597039146288084399804970321650786343926762617050267953804187637589680483747118520640215685823960565374257916606376614989068714519221200526153337339231811209103691670332448455568834360991376561934655791783777303158804192072480462427603081222477736127116487135829871159012088560949001195036438968055662623137699192144544779794083584680689540442724934989051724555543804881833667981542927559918281633920991286929649836467018615914506794562333077070693193184457099738637302932893202326166345587745545067345196638678783725361787387929584670375130156998341319410379896474038179007654663306092236453717662226310049989457236126979114859767647236208372611912682900943375627865077438570299990632285516390658087044607572089798351374956309450570927501143971166712052125543825884826775223374278897655628365169027395559920434945977927370701455167472244110119296263564544542951604839348800863982497136293640683147990655096408634126648080342366757815946414064871046334626361453930682155822527425370015620470094974004748225853436186198013182212681870184950352227642036905515140527159090529445739215243480994771335397153859377550111914590527066981787221770963578638428956610194969891600691242142450103855158650048065187304272895297580524456059058647274557406770972678244114785656869446956749642713995735628989728934837676823222732561313468659423917604677248335584211594858579067986032893815025814295833202742127849598302573489145001461720022692763015992424096737628836139378269119970438785545417338492117799151676935559651954192591221190912685702034474225379126062705249734753637640068862240703587725034323964717090783760147829097933951510446305469523349381900795357939352674206432235418802034332000679643703807193294650438158102012501691125340087366270784074764990967009620926470144269399759748400356491342935245737357306266564514367526540742669429040396812041834714318824334464231820606220817110700272831101180869788278913838028557819762657746882753445422826871051267593256005370488144999289016290914842315327252381951672228617124448195981527624239431522261611023083378995435271266575249417372408953218292566179867416312018920188427308303901182001105932227758121829718182553076299325801292841555292056212133457998374619735484292997883268066331149171532355467216232287585375270362250040964203679114544992938039986066379264801828596610183524057219182956367382208378108600292915536906007351395215544004339648326129049202892244406827082905060261284376402225715275908352886222151270906714491747717377597479753709675587248013512260733495348905018965327214912186918994066529431544037764506775043613011857733748243623711693752017115045716671898188321740478582038121984812574936077569946471869430571574310438929951232104576586106703495177898334276331310584528868913252171103666850902032455520173162392980254487029044048711396366758389948504143271442269785615240211538499034406713803029262141091237721312989769370709549370692060446006694133673056815731397235912818057543483252993785214640994097075281732976642527775346635424612369315945966222682389693012799297661218913719041858757318806037174649951545020219063046257472989303386375752391268952205453960408897854313574868608419191817822464882214391835587818518371959253504343908441182925250900556276506432502304787351550032088305695678227960087734723021875075644895990876137372502686852827711895336052401957404554674136507144579575514076025101015839453880810204153348592913579575397940576468247301955178871499165224342899170006081911409310324305757965959244695622089931034917821744484050620342966486438785504370402476804673974095952871862969747867265563812865932497505164357287704545800327511290849591980693976919290010605645997201004207619154460053864322762151460811065971652263747726623765746168729987610969207980206806377165540030226193952771051343197265564828606719752694972705840572879667257902125635311118758810252902609939950156481388255040909212449783403789723232217984592901975090296672629143550951207913898489584234235010221890995808654474330263634513839989639026389469088778314470079112140916601749680688350766773215902049473074156562354310522080265517142949954942303049314580052355257113954046683112525160613153556182731914097507064533699736443511527467555115690466204491470231892773912744219990895482724703500309321227690678663334347945583171103517915493809484831906506582193499494330248184124076460461291387437957265275284883722056389804427235460620309345848671778468806725858151919081864695653373970402126734918388318092931109317512269439012895805154330096376473381259285735537944338126103055222298751549193756035852027123527831993050737745908042825617199659994068450944132185892007931128891421234995317530029615581408189115836445613703666919583203043334437447733213789506415362866426502112194817177436751590144089071194110564560821551070125223034672208706247244243706088362058030901514951835962534641291280615984111085207376629604926040406630851075942169289415260574829071549422549875711690906788750462028332295702330601313980858059908434517812548902054102469613103540230035044232587717777805660555849420113944162873225493872905101001939820195899746313511587899086703395397943936514817912377516938160973393575921815962384931172903941591397141425276516448982889883372619516116342917377677395356401930615886148214120109521233807555763638313753998641996449309072038211135797785046486075471137739899494186694739110028462720103512682527533493554159749274269850650131604048022003082382596738097764598621264566435473603066470698844994506178459866567892201636310290072609046237867897481097936733974631113610169125038061177695217701754107283213794308124391693849873043048263930868035314937856956090267645999525942907137217071229825509653320090811137986104117295847082865284060290052261105374261975164452130374199395332711794993503107252798907896009966134016676141796745657335223396111249847864103636033600762651496095509093901614748972705126832895760186561222639720973851774459136092151081394582390383667678211138703353910574711902669993755780671954837681657116733329566299187506121511168334553727027889604480975844205864684380851386297820046521103004789945380881126199843422355722654477579572735521805427754867407749448509324790538852932361868110569617061318039771532201633287997109974723253515467305101779541039675396978704641398857080604579186595823400611515336791655654598456587410937203627108115856408097663224001366413977865798486074254044500402385848412085292747686114693013526877667574550950323969435760488949040802526618345025989942783319531987175474414115479034182970764652626753244227927776523665589998856652415946476300849677635064637258926647206757300410033770960796992937499406507423398679118962054046584466747197583616260542296460061530879005708600385572808917875509472654292027160936049051271316973333149153412066733955439057777211044707141384303121995150381743767014756215440260389448121281096740753551870956184774664905701668458351108774264547837357252580555270000529139437523505164178396701044576059341162387480038935578766326927854900935378215195090491273627933459962564000624055996237048689812592322591222055013317095941313445864268262523443319744578989150764341023989386210395193792202203033808579110262885119217696211022819430306985493155889263421272715360797874953274335630655026439658118523323918600894937859792626474248452527399096795035564365196993693909533652662462404207885337214001231400217244987042136903762213119843816911938583834653254401708041005034643098495823189021081179511088446710209805611179714013321676234622014488790664316121114279583867454384508073867812528973316390613768754872787700692695383784418654911821188606452843210719234071700426349679834133723817725251725816512320391750497834216244327436657401634130009043690191125757739665451747415404985037579503868712115889705191167372882189698440097892966041657103513368044827739259117941591249327724154584753558051851101716424775327422547745282500147052972038707947389039664172570829017699935602188651776640274121673343466215616701398971923156151556450059333694857367549112953926972852246727542879550862692530067553218191287531459147382463210333767952572179454694407144499911602221168616076154785220097922881801979586964486068462899281128683960111647437733789241516951715072739791783821919266954644612569734905211083892290619465843633273881408977374965385759934440687425087887608191419072303095535117631147178016188327516804236763816115530985630952549101795483058932997407038929317571085903447013955647826566394420311809541610793395283709680219954734442665215348290108037491973376090400140596709652613285563447223856755060082920379375972434352292241467192776961347678657764794949691749214558011988072681071856966501295588924927529181612972675863213232742686002018048020223844847839083866403725146038010061894454033657508085488048566960258692789578255022479014470885728108130863103990813545452206381395784471441217451444731895007379741325255508975805941629571320889311329883686460423597786790018924544023415985402976372309285991999128832413115490628692490628220308889426228611616205857929087914404811249629946029919975509719478907717542264795499158230062406402260003013744734464170073974627051649658970703924028189723001513193132978366977845898488932142675797174472893207388463407421799287417040004808312278286582138723338935262474646789383046939718034809723778469156294126728082298751765637951917369993265379969129800404116552838134908939143099596944238251441958254443389135796009335785949990105400353032597281085234933310614359151021976727442245700907670337087955059616554973205488570860110869430775006334353956486460121271411664066790158261606513929001419729656645842593798098214828798974355793450070798405080702467753259439464834989307419235849046437799019452895112530903349427731599221044264855353412317009007248662918152934275652510482648489715817389060976939828323618397669477243109918705154325512606008627356569830295513369096141681597880923371013375480126835155159880028956857465637204892051868471175740391080841568993518613465163917415268701930981914653673772457232165618097344952033676822447158576655849043639011862853701068343929910814769862505136926347871044859322057832841653135643331049977202315942907520981908510866690753832237069463988192563360636108923138164518227065385886908716827519703303049694719303840711024484328008227835913665013473770583336551159651444787483671728639310377498994459606299834930297010999599475700250229425293252080112216966208326909494798943239936774140711176167078110046365414631981659300020261984609033729001406845855364012681758021169430306562776765802565764094720168996118116253770366750172976182587512681557535039882283757874015131080959005797347144306214894131026992547919897020666721419548713289612810050902007692172869330541627018998034098971702140252015939724574942428150584070072675195771751933372860739730196207614285008342758774822431298788563527171956710090067213039783570414551509739182290463830625380482940851054613604147230846304936342062964813884577907236605252798147121313290239261224676616087732094961872238832437613532540583015087042852007651164930122727851411223076517973734251120434731782579672615848523531045889835961569085513995814016159351613251642694601851455550696474108141083518333496339095357102835969103960576843491800479461495917603590828510757506110448605628808755819939888274614447847153520839681264944910178353687581467575216944238375035917762761514497062801206379639924750088994800666719105658961653171055042096510337816983145432918672336120178032420775603406564171761004604067822735444497733592854959364730961548017465795445984307386712150637666956703369953607114408145422082797606937746561486275800609786868225161981334655099524703181591460680680061296376225349938913373736237401614085123111000307422556821709092039744922443910050533364286076150296285889370643259774353167573174960852753116355023880091395316585172184763553223566190103009648394392648226046730897281246152807915239457012346031602756855466543287126144448902782932554468330864793675643190251319561864793627060932212440937277284737474725108740919644767581896253167886978896867139230384298393064802807878005064313692505372631554502991419461171275452217766875287654816059543101709652593252436459398644081945933637853159134657685354432651832429639874702780038682961099762738599879273684138479905327758663945655261701390776382531829647890726853504680406108424277210367086560200549242174601557121952345651505715283552381854477055937455665303239002897537273485303279875550772106100563115466586318714382633435677764173875576509096645601115883109661077357281500711882941705970112062391096173236763513030147051441573126270983028190399036872403896681040626526937576190055031377258474401292006899629545747350806889219339280986936852919918429013152340246018138558606373585565254629092858194696865476857099628288119637241368389061520321993243242972379502653194377042218413554660785213022916187504161062938487315572642527867704188905985318798867904936123466321161319877304664372371725873796483372039338690102848721916129032195869414417262239208407672650502637812859476594659826306091903301041137808885193690675719277489357079540944247597249228553115412583747367606089788181763545631499866191824233188635126840472398280427969086040214696014396302623287674666095872437888326577466797665842138852845858922503039257379121502471957106218428259530416436794655175714266265387131620825347904536624971519438397123444075435602946964561002705834580073434031691731935806468787857268017611851201608897042640519541756153743575339810662094791442125680281295368182618652040751849127202905222775481534442713330604324215621399621449384832157536835433632622957970266445869761328652504884541838002546602001184747786456155439891320839937850697072272368131587276026361391353446545468627128219930424772440159963927017016942732521626085488810742879285481496941197413025438802459778578657331408664842474398590846100514825719527868896050042133856714407677018929928450221110442400120791157212607235689230290073958311428680256367559809970553078048490671695685399214273034648721539615527816725977372989872156333565880173509482808181963770144941818382633599516482247595546620029481641907012244913305685921361281616893350621387592792108530268448704322373759968955535378523123562481786056916147519667154504187428585628764970619254834407769420531323250872538411882453555262787584299377001781027909130631035308914486947247221764112729797644950381960977952400020828101584188033046122785462981608704020658461729151004841058552629103129152612489902318619095005028141254994942821310591893426881797488142803663656366722531073222036573467201245999931775158794724348697207668178636718709693692409711434976837144539128735463996442050660763683497716956198588899891500133926851438468142893599087684845007122828054125902426976975430278627474298273448889296022854217616066217085471945365576259017643336952239508656667963376587984115747223782445206260490719766327242690323204534155812426734213064345684963398896851290660384730808176588220062351639056280264707053796976052448501256315623358071754868996584974270447387643688849485911333137657818150481648839678155941366076747824943522084912384796087875383313388853299164919482750221397408409014074184594039478296695253522381404375654725816826924611248887403716146421372590372667552576969849946547784703119013362469597985784906346980223888331485925137518605336010418992481739760479018552214214403462279856925312387564823239708044863452106927495130668041254453101663512254690880639798604244771938062926525584833948689908882001922533435413533039431624827314408557412561108120971173622319213832649092958858597022550731539158387470880807150038276027341875082080383959207152543775079045756290238297737348255460008723230045859596155880248178591124307678284825637676963411648990562616819754160077138748615256275088923607279559824259832539812529944620620071696256413005879641978909782551232508159899444636130573846941242333982984400622581508337059894227468547946680526993807108593760769888016734471017798765114166344654537651984716683250193247345085975141217695072073988690648999042035073672024298578855737656670282626830772776560683626401643260100129073381810506003552993123039143734424930637625028446570420465789529303319116241690645639089382788803726977092279398588181168462752813090717802479761413215184700405814830157024126241205020686924292113777778160324959834592425946420643466803990874960482382046049478006454557366881942665833692966774542642472109005480666152056327224085739978472732944573055075218042312287836020329417066808773982187068515607340671479573486203857384069333733276459807618026704924013589613645003989416446671573645839414746938258167936401087747895352293712656893074875932829589076957674938346872515827163241824704574809179542618682050297940516327345598054800631795877852974520529737432552784519405861722605326149019856834501383401014346276623954870444983192703679424890784229618747616541722088161570390426112306262877103931541461861663354715095102945610771647432678919914956373184578740812794692512231456765672168335028244071784963026455168037255757505184147260120318875155109871052304591848669351256508535594648215473015195700367658434780929726477888848177894196808051805363817716607181630734543510467371259506825268021175523635923998024199513334810052342343706796994794066890254482063325857627404312047537714346667267429042479109979020417959620835866956045904573384150609317426326329421587694981183264461663155485884740930837842075950906919254022150273948965650827767960751536553740620159045859252320957421335750289166252519042113230987007445179659697129707214897162755228957954044396709347419104999516219947842956799755939311258638044045483190835843725104739133947368916795103320227998414155064047001860188186733911304015076292495037715827383949055627979033259653241568947444908819215766611420093681859464227592998041289904844534804895446468961018730393052887232389218412959434026921991915508356639350294350496945438816312157536709743362602959459802509130935557275187382973084065821433055395716458113522122324881799051016939078774824130325741053704651781000153368087071500448412248635080166058648319189008163207200886171353052260798342211997038890864546280291416731525076320847584088403354339258246907763799874965761594223671995824328137411360266175812647902823552381216277670626549093439025780524947491626340821021708150132508590562054010268797483652170723381453253710283070725577875326751904915119304582110437127287936506742700103643174158072370111059709088280204283617084139910584758447991991438697878394436067964817233769205608623185667210961421638857806523895501603545074785297268009231482072619934899418098907235625933494884537520707563805200341484923745978894313985120250650928297225150319724384620497269045920543520270003529082375544327826664929556387909795191293549689155325022284900360345286154645338328023408181421162878956286012724461190323099423740567420995485661395460548513924070240528658443425032999571935675165563961656697489939965600240904560290611757374710581348212911206924223057549803470478930574169296705762433726642181676368337489037949806896348625788001272900774112677272232286720954794313417272920516254304192543776808956035452677162689468236144969339599413169560320748369016731645215211605993255825773656697501111200830263173632348034111061402590935103202461550216387197652181868940492340751594233754748380531082673740333730725307138917088332190721195127179273906379346517743117459967792218571407546220923988605891915767725229620029469583366078380429275291672851702594482687138228304405939211829673580049095054786519523061846303914335551607604484262104649075552534069916170135194432816992589802101239740106636908567052687424923614336687349607772895802886182710806773323052807890160797132962171083298718543611448253245187960851920687851146203622948149134602270833989822023863512721441949199808653658474546072812292672946738000769766424133935527222866635245814779667276532031113250499952692223473297296813125308636861130910617678236453671009024816439633290467350031180934325282708371615901561626654652077953674984614334761063875505799220222757242544997621754090030445154086441510879858199909490832955938014921509460906906041155211052442972015615028523986565862589627904533318270818962099497042675810647072936739443045553674108389093254001805286243028737956031639776937513467938802436647941846464578450314743820210983309584183402811405738562797587106321500795028696018924982250114373413492083587448200320096426027354436443127427084674996999266826863458519794118496350723910928559619782706448536408260061916969321820110015602458686151393784377834950585072232182737920747390269370032885266817018382426057202307708164831481904687478936928315086665078818775907886263292460736876379023548115470709390922863747937407112484067169264449037920026310270671406194461908381328350704628517673516872102339142132632009093679272935869148984867193178292647515467659071796208797285962806053366213471728337576636957203623074717474288393790664099939436688399184102307331940902687243993948957815412138296874146554919003450344616637901852421285155802263274704624579079053108942085373482203896792526979888201459796362912834663851739705014965392263382173631793995679176466060231779429596400608035529107215134642722123204501844903903953334737320965848489007533906129288248298107861598791742403897361154748020829582159061701343195370058671065859855857106571793654304169506638054010330631606404462662848966610443751755028398209476395033269324635399435979803671125655944943231367527812688413985419214775614446955507868404931005924917183410529198589359362463686963329863353260869712043841552848410114424279752707219055041712912857467587331667086432158042784254245015884160807672893900756788305992473569233561167242005014243757496955463096066984206220197393463827327315250017051036808446497182536594064751841899846773605708907329491411406363588611080177416257385134532372640939527647867107590564556142456206442335298357283315447552675234986112042877931044033400394373227384911060402655682360140200202754124710513029251712351838374099068649951157846630606560191837122543627224816771124617892996406840801541711312202846902489585693724517458520711516338140614043516934521634659563154589132127640990980526771492301126765646651346621043906990436316757920774840025673677560548085572810014305166944709892583243355998370140854683150065354288715788095301648387666287601421906499576447968793243368942556135753473635240012842570615081771344256374413007062559350995207888430822154097036171299793681797932551817178319904067221359854962702088609821326699588821921788730417454403364404054113857802125709484227930103507364660907466755229319633517361885870360654282547749737435602108355330656904278484598267500790408796751548040815529737194699084703635272458445419911598181129195191044656257328842143089053678630621208760993301586891864331615359780264192536499722960439672801175109205256975729128538380349311045750662911415035890749838217399430950649094779227951591812447319051625483089735405340856017092748020976957304491811361389677250262570287405109987768825390785028745546181066550626546627943474328183386960623409224519863259072200831063915774502698796211583243658113722370262419549382595331048631434515174510787389741472505270043464303263077671173465478027652813749135953076425928836129315615476590866384048450210017136840494515376322192333850136632505911809245139018527068706958616302337335623289211848785848238907321949038974225198187233400455167425839012001297384894269985730905982971538722495685741172528273071023978124251468876055929883695562669673213500953088701716640317675223662041251211447639908411212062852170861204816020124991387784905442733375223871795541065190308546335381221062258685830539168983489118107221262169668444125611908964141249065944007909086840451708884111630291830271251330576986633352911946095214604258860270986297940396665661928175628456465295000231035873019942474889918216819726889784253409314565634788894243062480644332627156246982266393601139367523267541544275718433537788564113462482868208072671842187058268745248058326999448857364170145441995530734637186259343176784393977085073591624398391908874426944007283222634180770332328746026479600449143879316266727609187489017219384356491765165999317096160157828565997368755747893888959227292779591487539191809543836891681422965322069874805401574937695478775905983628655874787864031869891001826753135073490692050623579139697309099443980483547122840019897418429403921968807023985304576349944501113161951297745256350675836023463145577736896518492891772334793233149507856750685182061835616618590301368604284687452761661279534668306404033140152826546480574050638207082530500743956571318317403088057600535131915010414436628377433066049330937936371156375178504148746987569526769234328538852799030101212437145497038158998520452096130736775862806903959267696835251697779976714265548278722389782236210871820771285760422891571108234369546118901451380243064384005393119463378968394600059105940568450823245109955649139196797969133215005582284887113219146124677461847120408032338886949058654972944302251905652188770214294461191851058318374706887071641728030426865771628257541250572341767188058566493860177166095600118612639837548398284156757482871097545754617189615155667371750714793482385537746482111932163475794596710152626503491012195334862451837918694210390104571855181484013330627967684352132311105383646495646805292994949532182667240333255875560469603396201454225989207780404772866893662581721669949599360227858299304637722489348641377359687432270878572200376540741330072482074582385463772265978002347788323434833697148024545749832971245532159568490201750697582533091215409731515894451904589506378473603388744454591702237947314180897402213596043887058152128996199620344735309895733208809397897471619690355917632812218945318523789824925097744721119305802292508800320245434729898306296846294960570121410694883533784291648459342229652889191794012117638849636391569367410562587653370079058155948996548886092014759709219602417668572292347883773723879177769321199198332186839508762417549393059266979384496619530224003048970436273881007916446486837694864686425379929867507461752978365474765311152483995320333978680016255842789671113708877004230768842630028537797429128902712727778067930289046216535756956290365633319484869984381820110704758150697933523977973924900720367196881790303264161362166484613014766418406973960068061514086525820886376130131467607297951611846502460074572762702342898456772776671373710537550449244096672625209191442521703134420339779754689634087207799342830987252951048133844768803380111229603416197163681585042439830152305254742035027906163333301015774816134805093570160231000084388098778896043054059878905317296119248694920860443922128271891736062065801044300452104119671868201852269240144990663659584315490220673009053336995163754480043495768007389072238679395336739478165435878607418987075244283234136939768548651159054072174269532025411228789774962814572235118178685751526024773099502160887449144707544920009556874258074267500699376944828708014256218805054548509630537783525269721788090786828898431452330375894140439065866868386327082038064733490306906475340578666103374522059334430389136906696007057364475335382778348048672741421926068532876918894568372514593220837401519643536996107514098568012929975713149821220314494128759881463451323620918368250310092703720411241532817974459757794672444888400475307313475593064694498776560843847240716447889167326507684905560794417081985666476079779792374570645795364847621610018240102251253242406254084406341601892521599460387735492086646036060907573638279803980102905845958167702608830186583930092484035189159020381440209626268072043568250008351460321829613527957321749372001351801833941474696565737297470404817781769962448997812032454822610581428738580890904888211394277097031961492686007755979608858813319882467591913524080092170104463754160020140891777374606836034927506816432113657782457296797695781433363065719413112719028454632358674052893107849962686180315385918300273229518190094280253222896072835593720167353185178355730815700661965396866294501020668850017262491165907571093076299555060682590801192758161725753622730750539335562592834352775718738683941259706308731294226275232271903805102614792681047772691309196748816399654260537950349477359478478616089668474827788254473583475151669735178997463053764220987007652529148845298651868248431729678650802065837418685488177187647056277807247386898081989828468796895538953736429449046167772090048323829910121715712359848639547367674251198554755509309474308197995421881407619734859177107164043155987429027755898325818490956302758008146373986930146679756167892684381723716090591384484369944655231068237642720770558995852797190242106279049704559606862196272668895002045223190794060283839710453284886308098444125747626478804911261014690175003721430729600862335198793040567718069574842661148425196525777624874488653975693790446013857920108344315976266465380450733475998299319615938574660266645303583834437726194532399922189123672119664343962449725322762707103218330387409472727885337987103709402511315030618251757836251700980578790908658214487673249078280024782839877122274808807393188324798071781167293011864145951763896269848793366843343419805917857166812229045375211542208416292664282966023594092825218838302597244460928932660570145402767223566707446116029802956259805087446173100439957904173518306370307470570465988574354611649758607441753439802693274559619567576073566991794344065077505752711638478022435526326582130719081319527705080702809085845303649145004657172238066357569763904211604210758382503775763928487720294079546764853098493867093459150841930620538358727260800486457834338085895271848048821340203600302021127618943592717922852883207006154822719560893218207488549777779275840059938478012781874905215128462968575916166483699419609185375399026444666588693885977272968884044354687517412964279549291286835299291626375128828370475019300305233560960834056600592172484426937767674486476291010657609297508829901029534908055681541845341583521431291317985681381688095722510184394316182030497782294751370919164416683581141445152501916598430750054984861116733764134434881673237730538471980325196714769295135159947096403100050095799237717312999467005638713522362017663611689660680755141733237946565099681511332453101688726913663723756825755567439025386999178632359923293613922549952847022273389933907881674693688830856193299897104554207735833709982842663858404335335032487754648173596865404656598922746298323723701281626052677389781010489496041272957481331393670208362851161299302576518179115018173275024459298701429326662373033955857401014748482352067090669366825038957704257505728484819287728965794673274010936934760784123709981569128768952941496848253348331474018043303232587483129431985275886767351320552705007683636862991995286541643019141185640260702839069124726455244000515136283664199944563627691256076642660105935645075330515342493920101609746596697244896433120683912893379329807199643049114384053881578640318482908123827095877984521983014059029220761992184932948360478865307923344218233314766884925620753884509825868881797854099183647982168465455337752806453650580686601192956799608050497199486473391043726076384533481480654177579605839237728358642252861324023766670373591048116310585474113409762271460865234914223595255341360200865387277667451915923216652338026227723150108422235171681535040117699664973420396576756401219893669550073518655170635355709842654621226523811834498254255409316332975347402831250795281898718991920812576435563178032212697654431950541105887118371144586418331365386867337589800341921591289289593181561443231195430308711513943903330003009869050807928926199712596528859865741989592884594059091247138555027921607338816740407192423579036131509889470721135375428362877258071605761445517255555980293517019131987149353940899219819907644149282349233535459973917908450599469854009127336131182943769832165750488757380881514684730018365860443720428680211135613953554650132101551074232196491909647705212331958171767780885377651471062310827267573485748691021603383532077140295015384997959191184240122204739352244578813781706569992158662326487673642795005982587604346249133459690468899320527037129132379959202982317946577987321522746943191544275760860608114120835934527225183918028110377189038176679163407349627012938636171204516286176866863227139817818892442111592947418741919926708267662069788269440351455311055553592135193125719826174293075335810996867526209027584139869233017322125607599783976558625503846204665961901623099190047995343395687563815515653552616453940584462338593379339490744232145283495141133062598932967875453749679596072170604783207117587107098171948800296717496355702985880317726761978160277826248520881182157392368443976502939475649712706920056715324967950879971420852979866012347701934546812666057807147172105231928093817538318757493770590277307693308813289003532306924129338925738696258241177684757611717413627588620512595591450698643895899831059057844071596686059518689321557219456600205461496859767580135801618009068266608386919691026371035966379374630760282791753478097745652995942855766945573113089952919704685514238791848914086616876069446344208593187519461509525409153693864811036056313786360699260995308885833403321255441733069390323898664210538871097220468714962460843973619205571390535758568737329475314412656836228744411527726380124504933077436620227911413606446979107286478964765323053493919104758823123053490272249227775252461171881615014053994715850265697794962372308479365349995266814809905054783493101696313108854135900139342843449598892426892621630589424473782235633038766145179364307731755653004975834698859137524734932892109855363181938331828492574409120741533109421744112706502382057464822731596307853560445325244322043641118483451832288798307047754018974303347853361712124032802715857306157695779906157904632344675350564582557450543168313830262312300697135617310868183931099618819194413950807637973144655113340283902399763646666114493198699101842375538543988457584679068890326275009391186863405929949722798289636282863297791552264548335829706710932401409788143765382427583093069838009259166933216566942726166534192201290124187396388221640123296584635929076567826785713626281808640103458081801779475667673160693250863060086908817127900123522483310377435152604537155481462922975242311382677792212523372721757884719758393206626032041036953983937423234461148276557020415272478174488473149396422404798843068041223353434711676856877580951748598361170409323363362627010979344571395972960274897971931681244356456308947697614704592206354941869229262762547081946174282630705922993886138801898573768283860248087110727284001153500028637466718199768158000348168213141102431433895144018614741305300894494374180650578599885650994580229789384366783817486544403606054616551177554189313426886166534575731818649851152028394700164271840015487497090289999280824431766159463468297277953718082202773532639542815149621773811356818303690451549071380863948976313798610983913616462260160292574357986517952427985965064196106423789068263969644849466969246327433323869525226806840372631279737684565532072755662499872970783347323216864303979319070827688567003578169599811523534852689280347209212209910585092650433557850691307986565130921098866665467296799012455499233019712306602917834806721143191587083372874740895246135373119431846249744254405729729457286573804413702106511533054192225734451338861199328130065823675873281601607032514873928682841714113459399025574800065243823738910263649126339123549450294213494350268358828606239263024233196017574724285235975633199652952843957103329167657392748260680949802823715997669576936617159333939218963395054956705427310314409703075747061808324317533501453746014665309137596694488160769720503917799921906870176474061975135780662702285321284316446681215540446079832245183710386894537294564858920571217750338671391101338326381533427027933442292178866373866740118027892790312911991130492137097660126918349321193892598042572147494517199724862318589348799800431675761223566977520859190975748491215899516689179523112168650070199630370296855953564717078292778140590503024860348417600237763771616803091540044384525187820349409387974332331964734555600681773260679537289662274585324399655878764485608074870256116247170244558160271539528456733317697500033871306232571830098536588802363060459264656511282747067329749783845726190488024843374318458877493187052588512916816691201044390939123979517421689561604694901036463824680610713994368566421431346789996046435750546707991969729998329250041366643045541611024686410763359528587330503201253592704365783467180344502006078009179386605135601504857714909014068847802928018082087076243588187232734613136250540364578480141124481939007456601008011540318546542325870060950028893105573318681976761045998116090032511620516584338678642027459329447335835000320309548191468395456971022158424911158147890030596519988819004807304189118415035057619570777053103229577151561297913809060155025176176712087918888442354202547070840317652465219469746914053726597449765120338437237954658136036194417012868935997913547848493991000160013306027506570986647146674437461078308178181657989755019815141160904022375483275761202393905543183844742219525717530692620685735837284954170035470874595354821375269030525690230652082063529830041769489790035995439308214643500026870146217499775054728301023644077132766685579873444816684504092408702027217235417503757794008168577608872486967625681959934456640495606866418735094492405471570684289634164634040075716664946440975277662078166166218348508436478278183947548197828985499836051275661211675205866448265576901598343127965327315573348866255734557012863270278733199266124881235581225017742994327204954897794561138857262432060038299913949259456683590555934285011837684151692975561234031474349922618643289510005817043380812811272551568160282969885996763058987043742125318949801065845024005348226227957021847378591942180847737857871780765977916136853333072166371896360115887147566860414244712912861862534322006415179719317559919877794606369997450530179761799551265214801521938602137687017377581690768185633483312329603030957049316155261017186298446801922425309173818972374908715887276288175285781071551442836854323954622659204437519131018370221247973609405043312782237673516773738724982566200453742133570211703604037858544015052242959775124507289263775677518251685234640297527713349921268317956832977941881809301656343998365446662109123050611866700726483369016906251330324232744532253576646542573531540397409771822718529098455616029764267366751931327970372104312766754738029282024993444225829721066825339619563961373380792127584206959282914035433566567173322485757132275298435802635086577406204365773996789558910089280572461454917245489843049406087944127503918742188101351077185363446103734858324358911773212243402087128733314465403301960838160792041265461056346387530615849682956129849620146275385032278574709522969439659864811500578949124297321772066665314504481367102774344183745957379078665749270065241102806210551425552170953466868204715692928694039966015998912508209989950438318606619907008786068091670019864694648996920315869568177374244248775045102974325614003659301863189169403299228157801246807167949273839687486389291169467476205801730118126997346397291270395693743147585440821071018678975733394393465896223175785589524057804291793683694193610254323984961773924113432621867758464399817323432684417854687397337328464563483056247500091462889112795499391267023637722108997683092750286753640437787427381813550847525221695404524714328688579432632470574713772218366874542570484572045139525740328227992430535449751575275950026158940387703233165859305845070368373255007792734498618647147893188551953422577831984927309242781121107748719485975563021835896554235834338572616432832601487933302095742578792304306642484306087568938096937353306477498904616611382215162685527632218209732884879268040555686804482715580809252030611354105445338255958799673171757519518970441737375108967841457715150256799104468296373538996130681621808005155344751522567617724968684517429629503169691745275695898338703275646864229538880869643227981624871373162715305889122058017789076443872409246948729191685318831815707990676631714386591315289627488734602183359081601754136243124574159340289495610044195973427935887261291269643336900055279142071902310603250463622703645766183315707733710996455118528756332556574309536253374837267531966442777669615244438739139317980448116713395113369157379361995454487291924708303915029290325861738188229923260803428997200278379758445491416433979832230509262097305937637413237352229894365019525244235138704536435835048702320296925245113671489206032981437371811030494573557147156110021627663680894810510416244697420592478255954213813501926007107503517601691720100244121540066123277975521858997335289806823232307567571744248561333865895539153716941184644782490261109594833964311136040020357447428774752262097257786028775580780794692356814879392282905947841955652318002216979869286554387503451993655819177086813504545714786530303526855441664160639843750210814087996126220321102820758911573649995569363686742221511448336317188280272505997418829887067657574445744097895140229315148811491050057352466516387731301447308663188988754959967083946253456216149412113976267442724890557352035140233301072329025191298786420692125100690440388298269073679836849531255511891168745039108482884938864229116735294610539955116251945875668783005958479219605340640009623952639245492797887113331699718275179744146460714492212265475837289972586683757920174678958250138388362304073655080818679554711091383396863701233934435224197328722116334373673488852148741974877250869399213289958752762829737083123693299813132849107634288666428124133421225269659350054896592168455771004195205958412300866365165812058252029465208095713583760627764151735251885445124008941331609235431160902324049166997657946727008223747497322125555818398606335741823897332829862792248684376775209110630296833636548588862101300159749906202616106175389546187964460970538659239679523100115386700293645687536695998089139621152421121788217448953733153294784597322490697718077679296252451281520996432681736029455877145474741006815128256734558024065286448261858745071905425494196397154913505255747814752058617039874788921218269771646449609903503822908604100607322104889443468776119461936484356600195986184687844211071785010729045639698203677959957340047936878631876409281694706846595431719601712281043721468048782142573646711185392207757228448059619324584285235756435666568178639585286536456221700758560573176691786614330400336780017255793178085162785257191090652821066815208245096765845913474919353589034550970402176347788033491635998753162379567202385433778103616576656075167092162969329778299592215557067515011614852258418133761205813703960637952141702313201699162436005684772395780024967239788426651573967786374056823141032166952808661815525954523070758535105151734603005956134260539790765679695526208940947407481646229552845437600902825270855958696495474888827659175123998300728242976280942871796809963579916218623956566195858551358584745149677425346215937627227047174238696246013366825785743100851510992275267462695108798669798184740492887774458020572829853078196901452325343811983426405927428921048384047184517778672355410850181907155115871998352768143596305848403525714326371420161336998708736880118161304540573586319152967742370700963474184473153673926207086915346037098193508167752672226559000719651135557160723134700302083151103783782589392437154693789974124700577484173992658424965350740341445719855685229162140016122940582908108221086661130637800656260913006409315300504438000022198354007858257571066553638017614481458608061074380795326767824257293541084594609858488486834877552607637936006019175917316287483047907692343492663362974448117838501734490751109654854870378359864578418719512082060511543423948199009178230533493750353609857468724427828291226362137466153421659463878791347413955364017472961852717154752893173489064733250507884990871376403798868782113843267624812397317488858544310680582218587500031607703111527168203146736577048899973898278892544194923267934734509749946403498878295379008133682080010098452042223255889557431002499625273034037081604330025597942496241439354435547905523193371270770159624593267910296767767487589419065198453995950728343551813534144952762880723421965342443267188780125681783981545968689797562868153772808260073877209238634922340154789728202851148940862287080977835080839873334183553533421600682845162762702695824850579637391428812086532698369367356611036752817788775129171748112183637572749372906299495509055012010372830148034072101787226290005930855127178062988840785058146198562851230437973895311877643899896344889495593693538261472322441415068147591902612646789762395685352563621145015777032826046395690410683616546866503727713884562859819621884116994308814346817001585077980085911025807654112706079958053464235963568054466804810332990733755099594506437447233723954237278211378606137115818884072285766140720582409428222786604082844303528146308456009506729716792518968779677000483428400766456669578859610028590451980865546717100513083535410987312462595915715114394193058645189090252889944574824192360925921148359800540245839969740469290459134227520953073273081618631352877634600489274647895595036504856163547021725393119284826072701168831529305701026146763336594008004330010434054916205771596933645143468841255651327892325283112905396674039052211805615099740869939440168779508669271604621903198165144013915990121548889422509860322755950823365749601936655187617783025634619077627678104961990775822173357135058651469260249997966895967226243549779037388805302005451929253995127157649399468539222443355094652059072659511791116482361375579964664356882701537951509372301284629638535040826323984502729231122775142420684864137250281483603615090819630594947543652771683592227648814956643652717260589470367612402700408463760123714096531030003065354832383243807946006087417816019689038355352245693912660615757844872331401528454886152959717749316156261583095964863535279076794354035056318714399653429596636142971307585175769605503657887448021717823966452099089947064278137524877961751284722930562033185666942844041369213899675717208474159834548544086462795681206374521486526923727926212766340741511861535789324881236739247925046724827524934707666829549617390867628226767872632293269610595009740826728145930015815387283069563404000859967240128471491004491451457560492537305774665594358234197103399050941084388120278671602758266535886330774112862204260569078423698719326378921613227449775007642700382110621146715318733095545382474143894788939785842823807898469693344998776789847223841994812701776189065135540366776034647820767394478074530692665209370958145690845394644685715951311256376065696662536823041826995445167627504740210792432238774278423150282580682490394777270833342481040184326728611730551288659785338100030675728006675307286165210298323076031036706660256245621410445558406644230127680428029595202381747788627275407055681280630522348210161010266941014818643954377273984720756379261882616578228557312621398245762278076272745107287844238847512251641064253604846725156545117454803495551526631709208890239353898907942921177341355399168497933714792572115232934370470385344088075486069266980985897839892608336922840275435053596423635344896763012358250692999737878269359504021431240971776977212431384257707231780553851524952109511784110825148174622622874354371221208740166959433982838927431265940927207227401787208974656323118800725238094240259771519043407289998580606208580499378802891377771039772198710928028316427573482993337581048675601656499552896571432226000941113591910438766757035795426999839364700025861441711876328276418129282045155917828013441391892103019885876167606937776627151001334068650078812989405343827476666424458913925731609884260722814601998856104073715008172802307291218775874802298847731950162665709290168597848088989270717489088914895999607279290509497400835546065320750415140685665245177802888237300476903211511028203656593285288479206355386547795451531874951335844059751555844592310024590310230924581209608951038162979363029480386395381026361584790707310452697877603108392255860784302696035006152687898566849816413080069435661350031837501640717824164553699346687654273317084959430827508058218845283901486320889284149772737231460098603112897510064000336013868911855";
			a = "5918363896795225218794537171027822358601489229706300303613817103842818432588325278743473460439921851322757939741628827962045289760969235938344677481381479878991913354709496409055604684277317967576951233233742320970723474179174285195794614542268089872896519585483073168670755169335253752907228952475363";
			b = "8860401549046843003316833296719046043004900665631809340318086942182441992717156369106532031986394356643139265949158793223517975146938554272106872145953493285339774260283595150341114072593421126372553013213991171618721485033094742597302908463718150398246095212395545758152113535116269300087582984088123";
			n = a*b;
			t1 = Clock::now();
			ms = std::chrono::duration_cast<milliseconds>(t1 - t0);

			cout << "x: " << x << endl;
			cout << "c: " << c << endl;
			cout << "a: " << a << endl;
			cout << "b: " << b << endl;

			cout << setw(line_width) << "Info" << "|Results\n";
			cout << setfill('-') << setw(line_width) << "-" <<  "|" << setw(line_width) << "-" << endl;
			cout << setfill(' ');
			cout << setw(line_width) << "Base size" << "|" << num_size << " bits" << endl;
			cout << setw(line_width) << "Prime size" << "|" << prime_size << " bits" << endl;
			cout << setw(line_width) << "Generate Prime" << "|" << ms.count() << "ms\n";

			//Generate correct answer
			t0 = Clock::now();
			mpz_powm(result.get_mpz_t(), x.get_mpz_t(), c.get_mpz_t(), n.get_mpz_t());
			values.push_back(result);
			//cout << "mpz_powm: " << result << endl;
			t1 = Clock::now();
			ms = std::chrono::duration_cast<milliseconds>(t1 - t0);
			cout << setw(line_width) << "mpz_powm" << "|" << ms.count() << "ms\n";

			for(int i = 0; i < functions.size(); i++){
				if(!active[i]) continue;
				t0 = Clock::now(); //timing
				values.push_back(functions[i](x,c,a,b));
				//cout << function_names[i] << " " << values.back() << endl;
				t1 = Clock::now(); //timing
				ms = std::chrono::duration_cast<milliseconds>(t1 - t0); //timing
				cout << setw(line_width) << function_names[i] << "|" << ms.count() << "ms\n";
			}

			//Verification of correctness
			assert_all_equal(values);
			cout << endl;
		}
	}
}

mpz_class generate_prime(int b){
	mpz_class prime;
	while(1){
		prime = "1";
		for(int i = 0; i < b-1; i++){
			prime *= 2;
			if(rand()%2 == 0)
				mpz_setbit(prime.get_mpz_t(), 0);
		}

		if(mpz_probab_prime_p(prime.get_mpz_t(), 25) >= 1)
			return prime;
	}
}

long bit_length(mpz_class x){
	long num_ones = mpz_popcount(x.get_mpz_t());
	long num_bits = 0;
	for(long i = 0; num_ones > 0; i++)
	{
		if(mpz_tstbit(x.get_mpz_t(), i) == 1){
			num_ones--;
			num_bits = i+1;
		}
	}
	return num_bits;
}

mpz_class square_and_multiply_exp(mpz_class x, mpz_class c, 
	mpz_class a, mpz_class b){

	mpz_class n;
	n = a*b;

	mpz_class z;
	z = "1";
	long length = bit_length(c);
	for(long i = length-1; i >= 0; i--){
		z = (z*z) % n;
		if(mpz_tstbit(c.get_mpz_t(),i) == 1)
		{
			z = (z*x) % n;	
		}
	}

	return z;
}

mpz_class chinese_remainder_exp(mpz_class x, mpz_class c,
	mpz_class a, mpz_class b){
	mpz_class dp, dq, t, m1, m2, u1, u2;
	dp = c % (a-1);
	dq = c % (b-1);
	mpz_invert(t.get_mpz_t(), b.get_mpz_t(), a.get_mpz_t());
	mpz_powm(m1.get_mpz_t(), x.get_mpz_t(), dp.get_mpz_t(), a.get_mpz_t());
	mpz_powm(m2.get_mpz_t(), x.get_mpz_t(), dq.get_mpz_t(), b.get_mpz_t());
	u1 = (m1-m2);
	mpz_mod(u1.get_mpz_t(), u1.get_mpz_t(), a.get_mpz_t());
	u2 = (u1*t);
	mpz_mod(u2.get_mpz_t(), u2.get_mpz_t(), a.get_mpz_t());
	return m2 + u2*b;
}

mpz_class montgomery_crt_exp(mpz_class x, mpz_class c, mpz_class a, mpz_class b){
	mpz_class n, r, rinv;
	n = a*b;
	r = "2";
	long exponent = 1;
	for(;r < a; exponent++){
		r = r*2;
	}
	mpz_invert(rinv.get_mpz_t(), r.get_mpz_t(), n.get_mpz_t());

	mpz_class dp, dq, t, m1, m2, u1, u2;
	dp = c % (a-1);
	dq = c % (b-1);
	mpz_invert(t.get_mpz_t(), b.get_mpz_t(), a.get_mpz_t());
	mpz_powm(m1.get_mpz_t(), x.get_mpz_t(), dp.get_mpz_t(), a.get_mpz_t());
	mpz_powm(m2.get_mpz_t(), x.get_mpz_t(), dq.get_mpz_t(), b.get_mpz_t());

	u1 = (m1-m2)*r;
	mpz_mod(u1.get_mpz_t(), u1.get_mpz_t(), a.get_mpz_t());
	t = (t*r);
	mpz_mod(t.get_mpz_t(), t.get_mpz_t(), a.get_mpz_t());
	u2 = montgomery_reduction((u1*t), exponent, a, r);
	u2 = montgomery_reduction(u2, exponent, a, r);
	return m2 + u2*b;
}

mpz_class montgomery_reduction(mpz_class T, long exponent, mpz_class& M, mpz_class & r){
	mpz_class m, Minv, Mprime, t;

	if(m_cache.find(M) == m_cache.end()){
		mpz_invert(Minv.get_mpz_t(), M.get_mpz_t(), r.get_mpz_t());
		Mprime = (-1 * (Minv));
		//Right shifts instead of mod
		mpz_fdiv_r_2exp(Mprime.get_mpz_t(), Mprime.get_mpz_t(), exponent);
		//mpz_mod(Mprime.get_mpz_t(), Mprime.get_mpz_t(), r.get_mpz_t());
		m_cache[M] = {Minv, Mprime};
	}
	else{
		Minv = m_cache[M].first;
		Mprime = m_cache[M].second;
	}

	//Not cached
	if(t_m_cache.find({M,T}) == t_m_cache.end()){
		m = (T*Mprime);
		//Right shifts instead of mod
		mpz_fdiv_r_2exp(m.get_mpz_t(), m.get_mpz_t(), exponent);
		//mpz_mod(m.get_mpz_t(), m.get_mpz_t(), r.get_mpz_t());
		t_m_cache[{M,T}] = m;
	}
	else { //Cached
		m = t_m_cache[{M,T}];
	}
	
	t = (T+m*M)/r;
	return t >= M ? t - M : t;
}


mpz_class montgomery_exp(mpz_class x, mpz_class c, mpz_class a, mpz_class b){
	mpz_class n, r, rinv;
	n = a*b;
	r = "2";
	long exponent = 1;
	for(;r < n; exponent++){
		r = r*2;
	}
	mpz_invert(rinv.get_mpz_t(), r.get_mpz_t(), n.get_mpz_t());

	mpz_class z;
	z = "1";
	z = (z*r) % n; //Create residues
	x = (x*r) % n; 
	long length = bit_length(c);
	for(long i = length-1; i >= 0; i--){
		z = montgomery_reduction((z*z),exponent, n, r);;
		if(mpz_tstbit(c.get_mpz_t(),i) == 1)
		{
			z = montgomery_reduction((z*x),exponent,n, r);	
		}
	}

	return montgomery_reduction(z,exponent,n, r);
}

void assert_all_equal(vector<mpz_class>& vec)
{
	for(int i = 0; i < vec.size(); i++){
		for(int j = i; j < vec.size(); j++)
		{
			if(vec[i]!=vec[j])
			{
				cout << "Array Index: " << j << endl;
				throw runtime_error("ERROR: Assert Equal Failed");
			}
		}
	}
}